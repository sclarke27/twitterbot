!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.recon={})}(this,function(t){"use strict";function e(t,e){return t<<e|t>>>32-e}function r(t,e){function r(){this.constructor=t}H(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e){if(void 0===e&&(e=0),t&&"object"==typeof t){var r=t;return"number"==typeof r.length?new _(r,e):new J(r,e)}return new G(t,e)}function n(t){return void 0!==t&&null!==t}function o(t){return!(!t||"object"!=typeof t||t instanceof Uint8Array)}function s(t){return!(!t||"object"!=typeof t||t instanceof Uint8Array||Array.isArray(t))}function u(t,e){if(void 0===e&&(e=!0),e&&s(t))for(var r in t){if(r.length>0&&64===r.charCodeAt(0))return!0;break}return!1}function p(t){if(o(t)){var e=t,r=e.length;if(0===r)return!1;if("number"==typeof r){if(!u(e[0],void 0===e.$0))return!1;for(i=1;i<r;i+=1)if(u(e[i],void 0===e["$"+i]))return!1}else{var i=0;for(var n in e){if(n.length>0&&64===n.charCodeAt(0)){if(i>0)return!1}else if(0===i&&n!=="$"+i)return!1;i+=1}}return!0}return!1}function a(t,e){if(o(t)){var r=t,i=r.length;if("number"==typeof i){if(i>0)return r[0][e]}else for(var n in r){if(e===n)return r[n];break}}return K}function h(t,e){if(void 0===e&&(e=new L),o(t)){var r=i(t);if(!r.isEmpty())for(r.step();!r.isEmpty();){var n=r.head();r.atField()?e.appendFields(n):e.appendValue(n),r.step()}}return e.get()}function f(t,e){if(o(t)){var r=t;if("string"==typeof e)return r[e];for(var n=i(r);!n.isEmpty();){var s=n.head();if(s&&"object"==typeof s&&void 0!==s.$key&&E(e,s.$key))return s.$value;n.step()}}return K}function d(t,e){if(o(t)){var r=t;if(Array.isArray(r))return r[e];for(var n=i(r),s=0;!n.isEmpty();){if(s===e)return n.head();n.step(),s+=1}}return K}function c(t,e,r){if(s(t)&&"string"==typeof e){var n=t;return n[e]=r,n}var u=new L,p=!1;if(o(t))for(var a=i(t);!a.isEmpty();){var h=a.head();h&&"object"==typeof h&&(void 0!==h[e]||E(e,h.$key))?(u.appendField(e,r),p=!0):a.atField()?u.appendFields(h):u.appendValue(h),a.step()}else void 0!==t&&u.appendValue(t);return p||u.appendField(e,r),u.get()}function l(t,e,r){if(o(t)){var n=t;if(Array.isArray(n))return n[e]=r,n;for(var s=new L,u=i(n),p=0,a=!1;!u.isEmpty();){var h=u.head();p===e?(s.appendItem(r),a=!0):u.atField()?s.appendFields(h):s.appendValue(h),u.step(),p+=1}return a?s.get():n}return t}function y(t,e){if(o(t)){var r=t,n=r.length;if(Array.isArray(r)||"string"!=typeof e||"number"==typeof n){for(var s=new L,u=i(r),p=!1;!u.isEmpty();){var a=u.head();a&&"object"==typeof a&&(void 0!==a[e]||E(e,a.$key))?p=!0:u.atField()?s.appendFields(a):s.appendValue(a),u.step()}if(p)return s.get()}else delete r[e]}return t}function v(t,e){if(o(t)){var r=t;if(Array.isArray(r))return r.splice(e,1),r;for(var n=new L,s=i(r),u=0,p=!1;!s.isEmpty();){var a=s.head();u===e?p=!0:s.atField()?n.appendFields(a):n.appendValue(a),s.step(),u+=1}return p?n.get():r}return t}function g(t){if(s(t)){var e=t,r=e.$key;if(void 0!==r)return r;for(r in e)return r}return K}function m(t){if(s(t)){var e=t,r=e.$key;if(void 0!==r)return e.$value;for(r in e)return e[r]}return K}function w(t,e){var r={};return"string"==typeof t?r[t]=e:(r.$key=t,r.$value=e),r}function E(t,e){return!0===t?t="true":!1===t?t="false":t instanceof Date&&(t=+t),!0===e?e="true":!1===e?e="false":e instanceof Date&&(e=+e),t===e||(t instanceof Uint8Array&&e instanceof Uint8Array?function(t,e){var r=t.length;if(r!==e.length)return!1;for(var i=0;i<r;i+=1)if(t[i]!==e[i])return!1;return!0}(t,e):!(!t||!e||"object"!=typeof t||"object"!=typeof e)&&("number"==typeof t.length&&"number"==typeof e.length?function(t,e){var r=t.length;if(r!==e.length)return!1;for(var i=0;i<r;i+=1)if(!E(t[i],e[i]))return!1;return!0}(t,e):function(t,e){if("number"==typeof t.length&&"number"==typeof e.length){if((s=t.length)!==e.length)return!1;for(u=0;u<s;u+=1){var r=void 0===t["$"+u],i=void 0===e["$"+u];if(r!==i||!E(t[u],e[u]))return!1}}else{var n=Object.keys(t),o=Object.keys(e),s=n.length;if(s!==o.length)return!1;for(var u=0;u<s;u+=1){var p=n[u];if(p!==o[u]||!E(t[p],e[p]))return!1}}return!0}(t,e)))}function x(t,e){return!0===t?t="true":!1===t?t="false":t instanceof Date&&(t=+t),!0===e?e="true":!1===e?e="false":e instanceof Date&&(e=+e),void 0===t?void 0===e?0:1:null===t?void 0===e?-1:null===e?0:1:"number"==typeof t?void 0===e||null===e?-1:"number"==typeof e?t<e?-1:t>e?1:0:1:"string"==typeof t?void 0===e||null===e||"number"==typeof e?-1:"string"==typeof e?t<e?-1:t>e?1:0:1:t instanceof Uint8Array?void 0===e||null===e||"number"==typeof e||"string"==typeof e?-1:e instanceof Uint8Array?function(t,e){for(var r=t.length,i=e.length,n=Math.min(r,i),o=0,s=0;s<n&&0===o;s+=1)o=t[s]-e[s];return o>0?1:o<0?-1:r>i?1:r<i?-1:0}(t,e):1:Array.isArray(t)?void 0===e||null===e||"number"==typeof e||"string"==typeof e||e instanceof Uint8Array?-1:Array.isArray(e)?function(t,e){for(var r=t.length,i=e.length,n=0,o=0,s=Math.min(r,i);o<s&&0===n;o+=1)n=x(t[o],e[o]);return 0!==n?n:r>i?1:r<i?-1:0}(t,e):1:void 0===e||null===e||"number"==typeof e||"string"==typeof e||e instanceof Uint8Array||Array.isArray(e)?-1:function(t,e){var r=t.length,i=e.length,n=0;if("number"==typeof r&&"number"==typeof i)for(var o=Math.min(r,i),s=0;s<o&&0===n;s+=1){var u=void 0===t["$"+s],p=void 0===e["$"+s];n=u&&!p?-1:!u&&p?1:x(t[s],e[s])}else{var a=Object.keys(t),h=Object.keys(e);r=a.length,i=h.length;for(var o=Math.min(r,i),s=0;s<o&&0===n;s+=1){var f=a[s],d=h[s];0===(n=function(t,e){var r=t.length,i=e.length;{if(r>0&&i>0){var n=t.charCodeAt(0),o=e.charCodeAt(0);return 64===n&&64!==o?-1:64!==n&&64===o?1:t<e?-1:t>e?1:0}return r>0?1:i>0?-1:0}}(f,d))&&(n=x(t[f],e[d]))}}return 0!==n?n:r>i?1:r<i?-1:0}(t,e)}function b(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function D(t){return 45===t||t>=48&&t<=57||t>=65&&t<=90||95===t||t>=97&&t<=122||183===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}function k(t,e){var r=new N,i=new ct(r);return e&&!1===e.block?i.writeValue(t):i.writeBlock(t),i.get()}function P(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||45===t||46===t||95===t||126===t}function C(t){return 33===t||36===t||38===t||40===t||41===t||42===t||43===t||44===t||59===t||61===t||39===t}function S(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||43===t||45===t||46===t}function V(t){return P(t)||C(t)||58===t}function A(t){return P(t)||C(t)}function F(t){return P(t)||C(t)}function z(t){return P(t)||C(t)||58===t||64===t}function q(t){return P(t)||C(t)||47===t||58===t||63===t||64===t}function I(t){return P(t)||33===t||36===t||40===t||41===t||42===t||43===t||44===t||47===t||58===t||59===t||63===t||64===t||39===t}function $(t){return P(t)||C(t)||47===t||58===t||63===t||64===t}function B(t){if(t>=48&&t<=57)return t-48;throw t}function T(t){return t<10?48+t:t-10+65}function O(t){return t>=65&&t<=90?t+32:t}var U={hash:function(t){for(var e=0,r=0,i=t.length;r<i;r+=1)e=U.mix(e,t.charCodeAt(r));return e=U.mash(e)},mix:function(t,r){return r*=3432918353,r=e(r,15),r*=461845907,t^=r,t=e(t,13),t=5*t+3864292196},mash:function(t){return t^=t>>>16,t*=2246822507,t^=t>>>13,t*=3266489909,t^=t>>>16}},H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},j=function(){function t(){}return t.done=function(){return new M("")},t}(),M=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var n=t.call(this)||this;return n.buffer=e,n.index=r,n.more=i,n}return r(e,t),e.prototype.isDone=function(){return this.isEmpty()&&!this.more},e.prototype.isEmpty=function(){return this.index>=this.buffer.length},e.prototype.head=function(){var t=this.buffer.charCodeAt(this.index);if(t<=55295||t>=57344)return t;if(t<=56319&&this.index+1<this.buffer.length){var e=this.buffer.charCodeAt(this.index+1);return e>=56320&&e<=57343?65536+((1023&t)<<10|1023&e):65533}return 65533},e.prototype.step=function(){var t=this.buffer.charCodeAt(this.index);if(t<=55295||t>=57344)this.index+=1;else if(t<=56319&&this.index+1<this.buffer.length){var e=this.buffer.charCodeAt(this.index+1);this.index+=e>=56320&&e<=57343?2:1}else this.index+=1},e.prototype.clone=function(){return new e(this.buffer,this.index,this.more)},e}(j),R=function(){return function(){}}(),N=function(t){function e(e){void 0===e&&(e="");var r=t.call(this)||this;return r.buffer=e,r}return r(e,t),e.prototype.isDone=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.write=function(t){if(t>=0&&t<=55295||t>=57344&&t<=65535)this.buffer+=String.fromCharCode(t);else if(t>=65536&&t<=1114111){var e=t-65536;this.buffer+=String.fromCharCode(55296|e>>>10,56320|1023&e)}else this.buffer+=String.fromCharCode(65533)},e.prototype.writeString=function(t){for(var e=new M(t);!e.isEmpty();)this.write(e.head()),e.step()},e.prototype.get=function(){return this.buffer},e}(R),K=void 0,L=function(){function t(){this.record={},this.fields={},this.values=[],this.length=0}return t.prototype.appendItem=function(t){s(t)?this.appendFields(t):this.appendValue(t)},t.prototype.appendFields=function(t){var e=t.$key;if(void 0!==e)this.appendField(e,t.$value);else for(e in t)this.appendField(e,t[e])},t.prototype.appendField=function(t,e){var r={};"string"==typeof t?(r[t=String(t)]=e,this.record[t]=e,this.fields&&(this.fields[t]=e)):(r.$key=t,r.$value=e,this.fields=null),Object.defineProperty(this.record,this.length.toString(),{value:r,configurable:!0,writable:!0}),this.values=null,this.length+=1},t.prototype.appendValue=function(t){Object.defineProperty(this.record,this.length.toString(),{value:t,configurable:!0,writable:!0}),Object.defineProperty(this.record,"$"+this.length.toString(),{value:t,enumerable:!0,configurable:!0,writable:!0}),this.fields=null,this.values&&this.values.push(t),this.length+=1},t.prototype.appendRecord=function(t){if(t&&"object"==typeof t)for(var e=i(t);!e.isEmpty();){var r=e.head();e.atField()?this.appendFields(r):this.appendValue(r),e.step()}},t.prototype.get=function(){return this.fields?this.fields:this.values?this.values:(Object.defineProperty(this.record,"length",{value:this.length,configurable:!0,writable:!0}),this.record)},t}(),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.get=function(){return this.values&&1===this.values.length?this.values[0]:this.length>0?t.prototype.get.call(this):K},e}(L),W=function(){return function(){}}(),_=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length||0);var n=t.call(this)||this;return n.record=e,n.index=r,n.length=i,n}return r(e,t),e.prototype.isEmpty=function(){return this.index>=this.length},e.prototype.atField=function(){return!Array.isArray(this.record)&&(void 0===this.record["$"+this.index]||this.record[this.index]&&"object"==typeof this.record[this.index]&&void 0!==this.record[this.index].$key)},e.prototype.atValue=function(){return Array.isArray(this.record)||void 0!==this.record["$"+this.index]&&("object"!=typeof this.record[this.index]||this.record[this.index]&&void 0!==this.record[this.index].$key)},e.prototype.head=function(){return this.record[this.index]},e.prototype.headKey=function(){var t=this.record[this.index];return this.atField()?g(t):K},e.prototype.headValue=function(){var t=this.record[this.index];return this.atField()?m(t):t},e.prototype.step=function(){this.index+=1},e}(W),J=function(t){function e(e,r){void 0===r&&(r=0);var i=t.call(this)||this;return i.record=e,i.keys=Object.keys(e),i.index=r,i.length=i.keys.length,i}return r(e,t),e.prototype.isEmpty=function(){return this.index>=this.length},e.prototype.atField=function(){var t=this.keys[this.index];return void 0===this.record["$"+this.index]||"object"==typeof this.record[t]&&void 0!==this.record[t].$key},e.prototype.atValue=function(){var t=this.keys[this.index];return void 0!==this.record["$"+this.index]&&("object"!=typeof this.record[t]||void 0!==this.record[t].$key)},e.prototype.head=function(){var t=this.keys[this.index],e=this.record[t];if(t!=="$"+this.index){var r={};return r[t]=e,r}return e},e.prototype.headKey=function(){var t=this.keys[this.index];return t!=="$"+this.index?t:K},e.prototype.headValue=function(){var t=this.keys[this.index];return this.record[t]},e.prototype.step=function(){this.index+=1},e}(W),G=function(t){function e(e,r){void 0===r&&(r=0);var i=t.call(this)||this;return i.value=e,i.index=r,i}return r(e,t),e.prototype.isEmpty=function(){return 0!==this.index},e.prototype.atField=function(){return!1},e.prototype.atValue=function(){return!0},e.prototype.head=function(){return 0===this.index?this.value:K},e.prototype.headKey=function(){return K},e.prototype.headValue=function(){return 0===this.index?this.value:K},e.prototype.step=function(){this.index+=1},e}(W),X=function(){function t(){}return t.prototype.isCont=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.run=function(t){for(var e=this;(!t.isEmpty()||t.isDone())&&e.isCont();)e=e.feed(t);return t.isEmpty()&&!t.isDone()&&e.isCont()&&(e=e.feed(j.done())),e},t.prototype.parse=function(t){var e=new M(t);return this.run(e).bind()},t.prototype.bind=function(){throw this},t.prototype.trap=function(){throw this},t.prototype.asVariant=function(){return this},t.prototype.asError=function(){throw this},t.done=function(t){return new Y(t)},t.error=function(t){return new Z(t)},t.unexpected=function(e){var r="unexpected ";return e.isEmpty()?r+="end of input":r+=JSON.stringify(String.fromCharCode(e.head())),t.error(r)},t.expected=function(e,r){"number"==typeof e&&(e=String.fromCharCode(e)),1===e.length&&(e=JSON.stringify(e));var i="expected "+e;return r.isEmpty()||(i+=", but found "+JSON.stringify(String.fromCharCode(r.head()))),t.error(i)},t.isSpace=function(t){return 32===t||9===t},t.isNewline=function(t){return 10===t||13===t},t.isWhitespace=function(e){return t.isSpace(e)||t.isNewline(e)},t.isAlpha=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.isDigit=function(t){return t>=48&&t<=57},t.isHexChar=function(t){return t>=65&&t<=70||t>=97&&t<=102||t>=48&&t<=57},t.decodeHexChar=function(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-65+10;if(t>=97&&t<=102)return t-97+10;throw t},t.isBase64Char=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||43===t||45===t||47===t||95===t},t}(),Y=function(t){function e(e){var r=t.call(this)||this;return r.value=e,r}return r(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){return this.value},e}(X),Z=function(t){function e(e){var r=t.call(this)||this;return r.cause=e,r}return r(e,t),e.prototype.isCont=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){throw this.cause},e.prototype.trap=function(){return this.cause},e.prototype.asError=function(){return this},e}(X),tt=function(){function t(){this.buffer=null,this.offset=0,this.aliased=!0,this.p=0,this.q=0,this.r=0,this.s=0}return t.prototype.prepare=function(e){if(this.aliased||e>this.buffer.length){var r=new Uint8Array(t.expand(256,e));this.buffer&&r.set(this.buffer),this.buffer=r,this.aliased=!1}},t.prototype.appendByte=function(t){this.prepare(this.offset+1),this.buffer[this.offset]=t,this.offset+=1},t.prototype.decodeBase64Digit=function(t){if(t>=65&&t<=90)return t-65;if(t>=97&&t<=122)return t-71;if(t>=48&&t<=57)return t+4;if(43===t||45===t)return 62;if(47===t||95===t)return 63;throw t},t.prototype.decodeBase64Quantum=function(){var t=this.decodeBase64Digit(this.p),e=this.decodeBase64Digit(this.q);if(61!==this.r){var r=this.decodeBase64Digit(this.r);if(61!==this.s){var i=this.decodeBase64Digit(this.s);this.appendByte(t<<2|e>>>4),this.appendByte(e<<4|r>>>2),this.appendByte(r<<6|i)}else this.appendByte(t<<2|e>>>4),this.appendByte(e<<4|r>>>2)}else{if(61!==this.s)throw"incomplete base64 quantum";this.appendByte(t<<2|e>>>4)}},t.prototype.appendBase64Char=function(t){0===this.p?this.p=t:0===this.q?this.q=t:0===this.r?this.r=t:(this.s=t,this.decodeBase64Quantum(),this.s=0,this.r=0,this.q=0,this.p=0)},t.prototype.get=function(){if(this.buffer){if(this.buffer.length!==this.offset){var t=new Uint8Array(this.offset);t.set(this.buffer.subarray(0,this.offset)),this.buffer=t}}else this.buffer=new Uint8Array(0);return this.aliased=!0,this.buffer},t.expand=function(t,e){var r=Math.max(t,e)-1;return r|=r>>1,r|=r>>2,r|=r>>4,(r|=r>>8)+1},t}(),et=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.builder=e,o.keyParser=r,o.valueParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.builder,this.keyParser,this.valueParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===o){for(;!t.isEmpty()&&(s=t.head(),X.isWhitespace(s));)t.step();if(t.isEmpty()){if(t.isDone())return r?X.done(r.get()):X.done(void 0);break}if(64===s||123===s||91===s||b(s)||34===s||39===s||45===s||s>=48&&s<=57||37===s)r=r||new Q,o=2;else{if(35!==s)return X.expected("block value",t);t.step(),o=7}}if(2===o){for(i||(i=it.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(!i.isDone()){if(i.isError())return i;break}o=3}if(3===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return r.appendValue(i.bind()),X.done(r.get());break}58===s?(t.step(),o=4):(r.appendValue(i.bind()),i=void 0,o=6)}if(4===o){for(;!t.isEmpty()&&X.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return r.appendField(i.bind(),null),X.done(r.get());break}o=5}if(5===o){for(n||(n=it.parse(t));(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n;break}r.appendField(i.bind(),n.bind()),i=void 0,n=void 0,o=6}if(6===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.done(r.get());break}if(44===s||59===s||X.isNewline(s))t.step(),o=1;else{if(35!==s)return X.done(r.get());t.step(),o=7}}if(7===o){for(;!t.isEmpty();){if(s=t.head(),X.isNewline(s)){o=1;break}t.step()}t.isDone()&&(o=1)}}return new e(r,i,n,o)},e}(X),rt=function(t){function e(e,r,i){var n=t.call(this)||this;return n.keyParser=e,n.valueParser=r,n.step=i,n}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.keyParser,this.valueParser,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(64!==(o=t.head()))return X.expected("@",t);t.step(),n=2}if(2===n){if(r)r=r.feed(t);else if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{var s=new N;if(s.write(64),34===(o=t.head())||39===o)r=at.parse(t,s);else{if(!b(o))return X.expected("attribute name",t);r=pt.parse(t,s).asVariant()}}if(r)if(r.isDone())n=3;else if(r.isError())return r.asError()}if(3===n)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone()){return(u={})[r.bind()]=null,X.done(u)}}else t.step(),n=4;if(4===n){for(;!t.isEmpty()&&(o=t.head(),X.isWhitespace(o));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(41===o){t.step();return(u={})[r.bind()]=null,X.done(u)}i||(i=et.parse(t)),n=5}}if(5===n){for(i=i;(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone())n=6;else if(i.isError())return i.asError()}if(6===n){for(;!t.isEmpty()&&(o=t.head(),X.isWhitespace(o));)t.step();if(!t.isEmpty()){if(41===o){t.step();var u={};return u[r.bind()]=i.bind(),X.done(u)}return X.expected(")",t)}if(t.isDone())return X.unexpected(t)}return new e(r,i,n)},e}(X),it=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.builder=e,o.fieldParser=r,o.valueParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===o){if(t.isEmpty()){if(t.isDone())return r?X.done(r.get()):X.done(null);break}if(64===(s=t.head()))i=rt.parse(t),o=2;else if(123===s)r=r||new L,n=ot.parse(t,r),o=5;else if(91===s)r=r||new L,n=st.parse(t,r),o=5;else if(b(s))n=pt.parse(t),o=4;else if(34===s||39===s)n=at.parse(t),o=4;else if(45===s||s>=48&&s<=57)n=ht.parse(t),o=4;else{if(37!==s)return r?X.done(r.get()):X.done(null);n=ut.parse(t),o=4}}if(2===o){for(i=i;(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(!i.isDone()){if(i.isError())return i.asError();break}(r=r||new Q).appendFields(i.bind()),i=void 0,o=3}if(3===o){for(;!t.isEmpty()&&X.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return X.done(r.get());break}o=1}if(4===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}(r=r||new Q).appendValue(n.bind()),n=void 0,o=6}if(5===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}n=void 0,o=6}if(6===o){for(;!t.isEmpty()&&X.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return X.done(r.get());break}if(64!==t.head())return X.done(r.get());o=1}}return new e(r,i,n,o)},e}(X),nt=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.builder=e,o.fieldParser=r,o.valueParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o)if(t.isEmpty()){if(t.isDone())return r?X.done(r.get()):X.done(null)}else if(64===(s=t.head()))i=rt.parse(t),o=2;else if(123===s)r?(n=ot.parse(t,r),o=5):(n=ot.parse(t),o=4);else{if(91!==s)return r?X.done(r.get()):X.done(null);r?(n=st.parse(t,r),o=5):(n=st.parse(t),o=4)}if(2===o){for(i=i;(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone())(r=r||new Q).appendFields(i.bind()),i=void 0,o=3;else if(i.isError())return i.asError()}if(3===o)if(t.isEmpty()){if(t.isDone())return X.done(r.get())}else if(123===(s=t.head()))n=ot.parse(t,r),o=5;else{if(91!==s)return X.done(r.get());n=st.parse(t,r),o=5}if(4===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(n.isDone())return(r=r||new Q).appendValue(n.bind()),X.done(r.get());if(n.isError())return n.asError()}if(5===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(n.isDone())return X.done(r.get());if(n.isError())return n.asError()}return new e(r,i,n,o)},e}(X),ot=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.builder=e,o.keyParser=r,o.valueParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.builder,this.keyParser,this.valueParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(123!==(s=t.head()))return X.expected("{",t);t.step(),o=2}for(;!t.isEmpty()||t.isDone();){if(2===o){for(;!t.isEmpty()&&(s=t.head(),X.isWhitespace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(r=r||new L,125===s)return t.step(),X.done(r.get());35===s?(t.step(),o=8):o=3}if(3===o){for(i||(i=it.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(!i.isDone()){if(i.isError())return i.asError();break}o=4}if(4===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}58===s?(t.step(),o=5):(r.appendValue(i.bind()),i=void 0,o=7)}if(5===o){for(;!t.isEmpty()&&X.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return r.appendField(i,null),X.done(r.get());break}o=6}if(6===o){for(n||(n=it.parse(t));(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}r.appendField(i.bind(),n.bind()),i=void 0,n=void 0,o=7}if(7===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(44===s||59===s||X.isNewline(s))t.step(),o=2;else{if(35!==s)return 125===s?(t.step(),X.done(r.get())):X.expected('"}", ";", ",", or newline',t);t.step(),o=8}}if(8===o){for(;!t.isEmpty();){if(s=t.head(),X.isNewline(s)){o=2;break}t.step()}t.isDone()&&(o=2)}}return new e(r,i,n,o)},e}(X),st=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.builder=e,o.textBuilder=r,o.valueParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.builder,this.textBuilder,this.valueParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(91!==(s=t.head()))return X.expected("[",t);t.step(),o=2}for(;!t.isEmpty()||t.isDone();){if(2===o){for(;!t.isEmpty()&&64!==(s=t.head())&&91!==s&&92!==s&&93!==s&&123!==s&&125!==s;)t.step(),(i=i||new N).write(s);if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(93===s)return t.step(),r||(r=new L),i&&r.appendValue(i.get()),X.done(r.get());if(64===s)r||(r=new L),i&&(r.appendValue(i.get()),i=void 0),n=nt.parse(t),o=3;else if(123===s)r=r||new L,i&&(r.appendValue(i.get()),i=void 0),n=ot.parse(t,r),o=4;else if(91===s)r=r||new L,i&&(r.appendValue(i.get()),i=void 0),n=e.parse(t,r),o=4;else{if(92!==s)return X.unexpected(t);t.step(),o=5}}if(3===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}r.appendValue(n.bind()),n=void 0,o=2}if(4===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}n=void 0,o=2}if(5===o){if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(s=t.head(),i=i||new N,34===s||39===s||47===s||64===s||91===s||92===s||93===s||123===s||125===s)t.step(),i.write(s),o=2;else if(98===s)t.step(),i.write(8),o=2;else if(102===s)t.step(),i.write(12),o=2;else if(110===s)t.step(),i.write(10),o=2;else if(114===s)t.step(),i.write(13),o=2;else{if(116!==s)return X.expected("escape character",t);t.step(),i.write(9),o=2}}}return new e(r,i,n,o)},e}(X),ut=function(t){function e(e,r){var i=t.call(this)||this;return i.dataBuilder=e,i.step=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.dataBuilder,this.step)},e.parse=function(t,r,i){void 0===i&&(i=1);var n=0;if(1===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(37!==(n=t.head()))return X.expected("%",t);t.step(),r=r||new tt,i=2}for(;!t.isEmpty()||t.isDone();){if(2===i)if(t.isEmpty()){if(t.isDone())return X.done(r.get())}else{if(n=t.head(),!X.isBase64Char(n))return X.done(r.get());t.step(),r.appendBase64Char(n),i=3}if(3===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(n=t.head(),!X.isBase64Char(n))return X.expected("base64 digit",t);t.step(),r.appendBase64Char(n),i=4}if(4===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(n=t.head(),!X.isBase64Char(n)&&61!==n)return X.expected("base64 digit",t);t.step(),r.appendBase64Char(n),i=61!==n?5:6}if(5===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(n=t.head(),!X.isBase64Char(n)&&61!==n)return X.expected("base64 digit",t);if(t.step(),r.appendBase64Char(n),61===n)return X.done(r.get());i=2}else if(6===i){if(!t.isEmpty())return 61===(n=t.head())?(t.step(),r.appendBase64Char(n),X.done(r.get())):X.expected("=",t);if(t.isDone())return X.unexpected(t)}}return new e(r,i)},e}(X),pt=function(t){function e(e,r){var i=t.call(this)||this;return i.output=e,i.step=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.step)},e.parse=function(t,r,i){void 0===r&&(r=new N),void 0===i&&(i=1);var n=0;if(1===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(n=t.head(),!b(n))return X.expected("identifier",t);t.step(),r.write(n),i=2}if(2===i){for(;!t.isEmpty()&&(n=t.head(),D(n));)t.step(),r.write(n);if(!t.isEmpty()||t.isDone()){var o=r.get();return"true"===o?o=!0:"false"===o&&(o=!1),X.done(o)}}return new e(r,i)},e}(X),at=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.output=e,o.quote=r,o.code=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.quote,this.code,this.step)},e.parse=function(t,r,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=1);var s=0;if(1===o){for(;!t.isEmpty()&&(s=t.head(),X.isWhitespace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(34!==s&&(39!==s||i!==s&&0!==i))return X.expected('"',t);t.step(),r=r||new N,i=s,o=2}}t:for(;o>=2&&(!t.isEmpty()||t.isDone());){if(r=r,2===o){for(;!t.isEmpty()&&(s=t.head())!==i&&92!==s;)t.step(),r.write(s);if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(s===i)return t.step(),X.done(r.get());if(92!==s)return X.unexpected(t);t.step(),o=3}if(3===o){if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(34===(s=t.head())||39===s||47===s||64===s||91===s||92===s||93===s||123===s||125===s){t.step(),r.write(s),o=2;continue}if(98===s){t.step(),r.write(8),o=2;continue}if(102===s){t.step(),r.write(12),o=2;continue}if(110===s){t.step(),r.write(10),o=2;continue}if(114===s){t.step(),r.write(13),o=2;continue}if(116===s){t.step(),r.write(9),o=2;continue}if(117!==s)return X.expected("escape character",t);t.step(),o=4}if(o>=4)for(;!t.isEmpty()||t.isDone();){if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break t}if(s=t.head(),!X.isHexChar(s))return X.expected("hex digit",t);if(t.step(),n=16*n+X.decodeHexChar(s),!(o<=6)){r.write(n),n=0,o=2;break}o+=1}}return new e(r,i,n,o)},e}(X),ht=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.sign=e,o.value=r,o.mode=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.sign,this.value,this.mode,this.step)},e.parse=function(t,r,i,n,o){void 0===r&&(r=1),void 0===i&&(i=0),void 0===n&&(n=2),void 0===o&&(o=1);var s=0;if(1===o){for(;!t.isEmpty()&&(s=t.head(),X.isWhitespace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else 45===s&&(t.step(),r=-1),o=2}if(2===o)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else if(48===(s=t.head()))t.step(),o=4;else{if(!(s>=49&&s<=57))return X.expected("digit",t);t.step(),i=r*(s-48),o=3}if(3===o){for(;!t.isEmpty()&&(s=t.head())>=48&&s<=57;)t.step(),i=10*i+r*(s-48);if(t.isEmpty()){if(t.isDone())return X.done(i)}else o=4}if(4===o){if(!t.isEmpty()){if(s=t.head(),n>0&&(46===s||69===s||101===s)){var u=new N;return r<0&&0===i?(u.write(45),u.write(48)):u.writeString(i.toString()),ft.parse(t,u,n)}return 120===s&&r>0&&0===i?(t.step(),dt.parse(t)):X.done(i)}if(t.isDone())return X.done(i)}return new e(r,i,n,o)},e.parseInteger=function(t){return this.parse(t,void 0,void 0,0)},e.parseDecimal=function(t){return this.parse(t,void 0,void 0,1)},e}(X),ft=function(t){function e(e,r,i){var n=t.call(this)||this;return n.output=e,n.mode=r,n.step=i,n}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.mode,this.step)},e.parse=function(t,r,i,n){void 0===r&&(r=new N),void 0===i&&(i=2),void 0===n&&(n=1);var o=0;if(1===n)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else if(46===(o=t.head()))t.step(),r.write(o),n=2;else{if(!(i>1)||69!==o&&101!==o)return X.expected("fraction or exponent",t);t.step(),r.write(o),n=5}if(2===n)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(!((o=t.head())>=48&&o<=57))return X.expected("digit",t);t.step(),r.write(o),n=3}if(3===n){for(;!t.isEmpty()&&(o=t.head())>=48&&o<=57;)t.step(),r.write(o);if(t.isEmpty()){if(t.isDone())return X.done(Number(r.get()))}else{if(!(i>1))return X.done(Number(r.get()));n=4}}if(4===n){if(69!==(o=t.head())&&101!==o)return X.done(Number(r.get()));t.step(),r.write(o),n=5}if(5===n)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else 43!==(o=t.head())&&45!==o||(t.step(),r.write(o)),n=6;if(6===n)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{if(!((o=t.head())>=48&&o<=57))return X.expected("digit",t);t.step(),r.write(o),n=7}if(7===n){for(;!t.isEmpty()&&(o=t.head())>=48&&o<=57;)t.step(),r.write(o);if(!t.isEmpty()||t.isDone())return X.done(Number(r.get()))}return new e(r,i,n)},e}(X),dt=function(t){function e(e,r){var i=t.call(this)||this;return i.value=e,i.size=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.value,this.size)},e.parse=function(t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);for(var n=0;!t.isEmpty()&&(n=t.head(),X.isHexChar(n));)t.step(),r=r<<4|X.decodeHexChar(n),i+=1;return!t.isEmpty()||t.isDone()?i>0?X.done(Number(r)):X.expected("hex number",t):new e(r,i)},e}(X),ct=function(){function t(t){this.output=t}return t.prototype.writeRecon=function(t,e){s(t)&&e?this.writeFields(t):this.writeValue(t)},t.prototype.writeItem=function(t,e){s(t)&&e?this.writeSlots(t):this.writeValue(t)},t.prototype.writeValue=function(t){"string"==typeof t?this.writeText(t):"number"==typeof t?this.writeNumber(t):"boolean"==typeof t?this.writeBoolean(t):t instanceof Uint8Array?this.writeData(t):o(t)&&this.writeRecord(t)},t.prototype.writeFields=function(t){if(void 0!==t.$key)this.writeSlot(t.$key,t.$value);else{var e=0;for(var r in t)e>0&&this.output.write(44),r.length>0&&64===r.charCodeAt(0)?this.writeAttr(r.substring(1),t[r]):this.writeSlot(r,t[r]),e+=1;0===e&&(this.output.write(123),this.output.write(125))}},t.prototype.writeAttrs=function(t){for(var e in t)e.length>0&&64===e.charCodeAt(0)&&this.writeAttr(e.substring(1),t[e])},t.prototype.writeAttr=function(t,e){this.output.write(64),this.writeText(t),null!==e&&(this.output.write(40),this.writeBlock(e),this.output.write(41))},t.prototype.writeSlots=function(t){if(void 0!==t.$key)this.writeSlot(t.$key,t.$value);else{var e=0;for(var r in t)e>0&&this.output.write(44),this.writeSlot(r,t[r]),e+=1;0===e&&(this.output.write(123),this.output.write(125))}},t.prototype.writeSlot=function(t,e){this.writeValue(t),this.output.write(58),null!==e&&this.writeValue(e)},t.prototype.writeBlock=function(t){if(o(t)){var e=i(t);e.isEmpty()?(this.output.write(123),this.output.write(125)):this.writeItems(e,function(t){if(o(t)){var e=t,r=e.length;if("number"==typeof r){for(var i=0;i<r;i+=1)if(u(e[i],void 0===e["$"+i]))return!1}else for(var n in e)if(n.length>0&&64===n.charCodeAt(0))return!1}return!0}(t),!1)}else this.writeValue(t)},t.prototype.writeRecord=function(t){var e=i(t);e.isEmpty()?(this.output.write(123),this.output.write(125)):this.writeItems(e,!1,!1)},t.prototype.writeItems=function(e,r,n){for(var s=!1,a=!1,h=!0;!e.isEmpty();){var f=e.head(),d=e.atField();e.step(),a&&u(f,d)&&(s&&(this.output.write(125),s=!1),this.output.write(93),a=!1),u(f,d)?(s?(this.output.write(125),s=!1):a&&(this.output.write(93),a=!1),this.writeAttrs(f),h=!1):a&&"string"==typeof f?(s&&(this.output.write(125),s=!1),this.writeMarkupText(f)):s?(h?h=!1:this.output.write(44),this.writeItem(f,d)):a?p(f)?(this.writeItems(i(f),!1,!0),e.isEmpty()||"string"!=typeof e.head()?e.isEmpty()||u(e.head(),e.atField())?(this.output.write(93),a=!1):(this.output.write(123),s=!0,h=!0):(this.writeMarkupText(e.head()),e.step())):(this.output.write(123),this.writeRecon(f,d),s=!0,h=!1):"string"!=typeof f||e.isEmpty()||e.atField()||"string"==typeof e.head()||"boolean"==typeof e.head()?r&&!s?(h?h=!1:this.output.write(44),this.writeItem(f,d)):n&&"string"==typeof f&&e.isEmpty()?(this.output.write(91),this.writeMarkupText(f),this.output.write(93)):n||o(f)||!(!h&&e.isEmpty()||!e.isEmpty()&&u(e.head(),e.atField()))?(this.output.write(123),this.writeRecon(f,d),s=!0,h=!1):(!h&&("string"==typeof f&&t.isIdent(f)||"number"==typeof f||"boolean"==typeof f)&&this.output.write(32),this.writeValue(f)):(this.output.write(91),this.writeMarkupText(f),a=!0)}s&&this.output.write(125),a&&this.output.write(93)},t.prototype.writeText=function(e){t.isIdent(e)?this.writeIdent(e):this.writeString(e)},t.prototype.writeIdent=function(t){this.output.writeString(t)},t.prototype.writeString=function(t){var e=new M(t);for(this.output.write(34);!e.isEmpty();){var r=e.head();switch(r){case 34:case 92:this.output.write(92),this.output.write(r);break;case 8:this.output.write(92),this.output.write(98);break;case 12:this.output.write(92),this.output.write(102);break;case 10:this.output.write(92),this.output.write(110);break;case 13:this.output.write(92),this.output.write(114);break;case 9:this.output.write(92),this.output.write(116);break;default:this.output.write(r)}e.step()}this.output.write(34)},t.prototype.writeMarkupText=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();switch(r){case 64:case 91:case 92:case 93:case 123:case 125:this.output.write(92),this.output.write(r);break;case 8:this.output.write(92),this.output.write(98);break;case 12:this.output.write(92),this.output.write(102);break;case 10:this.output.write(92),this.output.write(110);break;case 13:this.output.write(92),this.output.write(114);break;case 9:this.output.write(92),this.output.write(116);break;default:this.output.write(r)}e.step()}},t.prototype.writeNumber=function(t){this.output.writeString(String(t))},t.prototype.writeBoolean=function(t){this.output.writeString(String(t))},t.prototype.writeData=function(t){this.output.write(37),this.writeBase64(t)},t.prototype.writeBase64=function(e){for(var r=0,i=e.length;r+2<i;){var n=e[r],o=e[r+1],s=e[r+2];this.output.write(t.encodeBase64Digit(n>>>2)),this.output.write(t.encodeBase64Digit(63&(n<<4|o>>>4))),this.output.write(t.encodeBase64Digit(63&(o<<2|s>>>6))),this.output.write(t.encodeBase64Digit(63&s)),r+=3}if(r+1<i){var n=e[r],o=e[r+1];this.output.write(t.encodeBase64Digit(n>>>2)),this.output.write(t.encodeBase64Digit(63&(n<<4|o>>>4))),this.output.write(t.encodeBase64Digit(o<<2&63)),this.output.write(61),r+=2}else if(r<i){n=e[r];this.output.write(t.encodeBase64Digit(n>>>2)),this.output.write(t.encodeBase64Digit(n<<4&63)),this.output.write(61),this.output.write(61),r+=1}},t.prototype.get=function(){return this.output.get()},t.isIdent=function(t){var e=new M(t);if(e.isEmpty()||!b(e.head()))return!1;for(e.step();!e.isEmpty()&&D(e.head());)e.step();return e.isEmpty()},t.encodeBase64Digit=function(t){if(t>=0&&t<26)return t+65;if(t>=26&&t<52)return t+71;if(t>=52&&t<62)return t-4;if(62===t)return 43;if(63===t)return 47;throw t},t}(),lt="undefined"!=typeof window&&(window.crypto||window.msCrypto),yt=lt?function(t){lt.getRandomValues(t)}:function(t){if(t instanceof Int8Array)for(e=0;e<t.length;e+=1)t[e]=128-Math.round(256*Math.random());else if(t instanceof Uint8Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(256*Math.random());else if(t instanceof Int16Array)for(e=0;e<t.length;e+=1)t[e]=32768-Math.round(65536*Math.random());else if(t instanceof Uint16Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(65536*Math.random());else if(t instanceof Int32Array)for(e=0;e<t.length;e+=1)t[e]=2147483648-Math.round(4294967296*Math.random());else{if(!(t instanceof Uint32Array))throw new TypeError(""+t);for(var e=0;e<t.length;e+=1)t[e]=Math.round(4294967296*Math.random())}},vt=function(){function t(){}return t.prototype.forEach=function(t,e,r,i,n){return i=i||[],n?t&&"object"==typeof t?this.forEachField(t,e,r,i):void 0:this.forEachValue(t,e,r,i)},t.prototype.forEachField=function(t,e,r,i){var n=t.$key;if(void 0!==n){if(void 0!==t.$value){i.push(n);o=this.forEachValue(t.$value,e,r,i);return i.pop(),o}}else for(n in t){if(void 0!==t[n]){i.push(n);var o=this.forEachValue(t[n],e,r,i);return i.pop(),o}break}},t.prototype.map=function(t,e,r,i,n){return i=i||[],n?t&&"object"==typeof t?this.mapField(t,e,r,i):void 0:this.mapValue(t,e,r,i)},t.prototype.mapField=function(t,e,r,i){var n=t.$key;if(void 0!==n){if(void 0!==t.$value){i.push(n);o=this.mapValue(t.$value,e,r,i);return i.pop(),void 0!==o?w(n,o):void 0}}else for(n in t){if(void 0!==t[n]){i.push(n);var o=this.mapValue(t[n],e,r,i);return i.pop(),void 0!==o?w(n,o):void 0}break}return t},t.prototype.select=function(t,e){var r=new Q;return this.forEach(t,function(t,e){void 0!==e?r.appendField(e,t):r.appendValue(t)},void 0,[],e),r.get()},t.prototype.update=function(t,e,r){return this.map(t,function(t,r){return e},void 0,[],r)},t.prototype.remove=function(t,e){return this.map(t,function(t,e){},void 0,[],e)},t.prototype.get=function(t){return this.andThen(new mt(t))},t.prototype.getIndex=function(t){return this.andThen(new wt(t))},t.prototype.keys=function(){return this.andThen(Tt)},t.prototype.children=function(){return this.andThen(Ot)},t.prototype.descendants=function(){return this.andThen(Ut)},t.prototype.defined=function(t){return this.andThen(new kt(t))},t.prototype.has=function(t){return this.defined(new mt(t))},t.prototype.hasIndex=function(t){return this.defined(new wt(t))},t.prototype.or=function(t){var e=[this.asFilter()];return t instanceof Pt?Array.prototype.push.apply(e,t.operands):e.push(t.asFilter()),new Pt(e)},t.prototype.orHas=function(t){return this.or(new mt(t))},t.prototype.and=function(t){var e=[this.asFilter()];return t instanceof Ct?Array.prototype.push.apply(e,t.operands):e.push(t.asFilter()),new Ct(e)},t.prototype.andHas=function(t){return this.and(new mt(t))},t.prototype.not=function(){return new St(this.asFilter())},t.prototype.op=function(t,e){switch(t){case"<":return this.lt(e);case"<=":return this.le(e);case"=":return this.eq(e);case"!=":return this.ne(e);case">=":return this.ge(e);case">":return this.gt(e);default:throw new Error("unknown operator: "+t)}},t.prototype.lt=function(t){return new At(this,t)},t.prototype.le=function(t){return new Ft(this,t)},t.prototype.eq=function(t){return new zt(this,t)},t.prototype.ne=function(t){return new qt(this,t)},t.prototype.ge=function(t){return new It(this,t)},t.prototype.gt=function(t){return new $t(this,t)},t.prototype.asFilter=function(){return new kt(this,Bt)},t.identity=function(){return Bt},t.get=function(t){return new mt(t)},t.getIndex=function(t){return new wt(t)},t.keys=function(){return Tt},t.children=function(){return Ot},t.descendants=function(){return Ut},t.defined=function(t){return new kt(t)},t.has=function(e){return t.defined(new mt(e))},t.hasIndex=function(e){return t.defined(new wt(e))},t.parse=function(t){for(var e=new M(t);!e.isEmpty()&&X.isSpace(e.head());)e.step();var r=Ht.parse(e);if(r.isDone()){for(;!e.isEmpty()&&X.isSpace(e.head());)e.step();e.isEmpty()||(r=X.unexpected(e))}return r.bind()},t}(),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.forEachField=function(t,e,r,i){var n=t.$key;if(void 0!==n){i.push(n);o=e.call(r,t.$value,n,i);return i.pop(),o}for(n in t){i.push(n);var o=e.call(r,t[n],n,i);return i.pop(),o}},e.prototype.forEachValue=function(t,e,r,i){return e.call(r,t,void 0,i)},e.prototype.mapField=function(t,e,r,i){var n=t.$key;if(void 0!==n){i.push(n);o=e.call(r,t.$value,n,i);return i.pop(),void 0!==o?w(n,o):void 0}for(n in t){i.push(n);var o=e.call(r,t[n],n,i);return i.pop(),void 0!==o?w(n,o):void 0}return t},e.prototype.mapValue=function(t,e,r,i){return e.call(r,t,void 0,i)},e.prototype.andThen=function(t){return t},e.prototype.equals=function(t){return t instanceof e},e}(vt),mt=function(t){function e(e,r){void 0===r&&(r=Bt);var i=t.call(this)||this;return i.key=e,i.then=r,i}return r(e,t),e.prototype.forEachValue=function(t,e,r,i){var n=f(t,this.key);if(void 0!==n){i.push(this.key);var o=this.then.forEachValue(n,e,r,i);return i.pop(),o}},e.prototype.mapValue=function(t,e,r,i){var n=f(t,this.key);i.push(this.key);var o=this.then.mapValue(n,e,r,i);return i.pop(),void 0!==o?t=c(t,this.key,o):void 0!==n&&(t=y(t,this.key)),t},e.prototype.andThen=function(t){return new e(this.key,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(E(this.key,t.key)&&this.then.equals(t.then))},e}(vt),wt=function(t){function e(e,r){void 0===r&&(r=Bt);var i=t.call(this)||this;return i.index=e,i.then=r,i}return r(e,t),e.prototype.forEachValue=function(t,e,r,i){var n=d(t,this.index);if(void 0!==n){i.push(this.index);var o=this.then.forEachValue(n,e,r,i);return i.pop(),o}},e.prototype.mapValue=function(t,e,r,i){var n=d(t,this.index);if(void 0!==n){i.push(this.index);var o=this.then.mapValue(n,e,r,i);i.pop(),t=void 0!==o?l(t,this.index,o):v(t,this.index)}return t},e.prototype.andThen=function(t){return new e(this.index,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.index===t.index&&this.then.equals(t.then))},e}(vt),Et=function(t){function e(e){void 0===e&&(e=Bt);var r=t.call(this)||this;return r.then=e,r}return r(e,t),e.prototype.forEachField=function(t,e,r,i){var n=g(t);return this.then.forEachValue(n,e,r,i)},e.prototype.forEachValue=function(t,e,r,o){for(var s=i(t);!s.isEmpty();){var u=s.head();if(s.atField()){var p=g(u),a=this.then.forEachValue(p,e,r,o);if(n(a))return a}s.step()}},e.prototype.mapField=function(t,e,r,i){var n=m(t),o=g(t),s=this.then.mapValue(o,e,r,i);if(void 0!==s)return s!==o?w(s,n):t},e.prototype.mapValue=function(t,e,r,n){if(o(t)){for(var s=new L,u=i(t);!u.isEmpty();){var p=u.head();if(u.atField()){var a=m(p),h=g(p),f=this.then.mapValue(h,e,r,n);void 0!==f&&s.appendField(f,a)}else s.appendValue(p);u.step()}return s.get()}return t},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&this.then.equals(t.then)},e}(vt),xt=function(t){function e(e){void 0===e&&(e=Bt);var r=t.call(this)||this;return r.then=e,r}return r(e,t),e.prototype.forEachValue=function(t,e,r,o){for(var s=i(t),u=0;!s.isEmpty();){var p=s.head(),a=void 0;if(s.atField()?a=this.then.forEachField(p,e,r,o):void 0!==p&&(o.push(u),a=this.then.forEachValue(p,e,r,o),o.pop()),n(a))return a;s.step(),u+=1}},e.prototype.mapValue=function(t,e,r,n){if(o(t)){for(var s=new L,u=i(t),p=0;!u.isEmpty();){var a=u.head();if(u.atField()){var h=this.then.mapField(a,e,r,n);void 0!==h&&s.appendFields(h)}else if(void 0!==a){n.push(p);var f=this.then.mapValue(a,e,r,n);n.pop(),void 0!==f&&s.appendValue(f)}u.step(),p+=1}return s.get()}return t},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&this.then.equals(t.then)},e}(vt),bt=function(t){function e(e){void 0===e&&(e=Bt);var r=t.call(this)||this;return r.then=e,r}return r(e,t),e.prototype.forEachValue=function(t,e,r,s){for(var u=i(t),p=0;!u.isEmpty();){var a=u.head();if(u.atField()){var h=a;if(n(c=this.then.forEachField(h,e,r,s)))return c;var f=h.$key,d=void 0;if(void 0!==f)d=h.$value;else for(f in h)d=h[f];if(o(d)&&(s.push(f),c=this.forEachValue(d,e,r,s),s.pop(),n(c)))return c}else if(void 0!==a){s.push(p);var c=this.then.forEachValue(a,e,r,s);if(n(c))return s.pop(),c;if(o(a)&&(c=this.forEachValue(a,e,r,s),n(c)))return s.pop(),c;s.pop()}u.step(),p+=1}},e.prototype.mapValue=function(t,e,r,n){if(o(t)){for(var s=new L,u=i(t),p=0;!u.isEmpty();){var a=u.head();if(u.atField()){var h=this.then.mapField(a,e,r,n);if(h&&"object"==typeof h){var f=h.$key,d=void 0;if(void 0!==f)d=h.$value;else for(f in h)d=h[f];o(d)&&(n.push(f),d=this.mapValue(d,e,r,n),n.pop()),void 0!==d&&s.appendField(f,d)}else void 0!==h&&s.appendValue(h)}else if(void 0!==a){n.push(p);o(d=this.then.mapValue(a,e,r,n))&&(d=this.mapValue(d,e,r,n)),n.pop(),void 0!==d&&s.appendValue(d)}u.step(),p+=1}return s.get()}return t},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&this.then.equals(t.then)},e}(vt),Dt=function(t){function e(e){void 0===e&&(e=Bt);var r=t.call(this)||this;return r.then=e,r}return r(e,t),e.prototype.forEachField=function(t,e,r,i){if(this.filterField(t))return this.then.forEachField(t,e,r,i)},e.prototype.forEachValue=function(t,e,r,i){if(this.filterValue(t))return this.then.forEachValue(t,e,r,i)},e.prototype.mapField=function(t,e,r,i){return this.filterField(t)?this.then.mapField(t,e,r,i):t},e.prototype.mapValue=function(t,e,r,i){return this.filterValue(t)?this.then.mapValue(t,e,r,i):t},e.prototype.filter=function(t,e){return e?this.filterField(t):this.filterValue(t)},e.prototype.filterField=function(t){var e=m(t);return void 0!==e&&this.filterValue(e)},e.prototype.asFilter=function(){return this},e}(vt),kt=function(t){function e(e,r){var i=t.call(this,r)||this;return i.selector=e,i}return r(e,t),e.prototype.filterField=function(t){return void 0!==this.selector.forEachField(t,this.selected,this,[])},e.prototype.filterValue=function(t){return void 0!==this.selector.forEachValue(t,this.selected,this,[])},e.prototype.selected=function(t,e,r){return null},e.prototype.andThen=function(t){return new e(this.selector,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&this.then.equals(t.then))},e}(Dt),Pt=function(t){function e(e,r){var i=t.call(this,r)||this;return i.operands=e,i}return r(e,t),e.prototype.filterField=function(t){for(var e=0;e<this.operands.length;e+=1)if(this.operands[e].filterField(t))return!0;return!1},e.prototype.filterValue=function(t){for(var e=0;e<this.operands.length;e+=1)if(this.operands[e].filterValue(t))return!0;return!1},e.prototype.or=function(t){var r=[];return Array.prototype.push.apply(r,this.operands),t instanceof e?Array.prototype.push.apply(r,t.operands):r.push(t.asFilter()),new e(r)},e.prototype.andThen=function(t){return new e(this.operands,this.then.andThen(t))},e.prototype.equals=function(t){if(t instanceof e){var r=this.operands.length;if(r===t.operands.length){for(var i=0;i<r;i+=1)if(!this.operands[i].equals(t.operands[i]))return!1;return this.then.equals(t.then)}}return!1},e}(Dt),Ct=function(t){function e(e,r){var i=t.call(this,r)||this;return i.operands=e,i}return r(e,t),e.prototype.filterField=function(t){for(var e=0;e<this.operands.length;e+=1)if(!this.operands[e].filterField(t))return!1;return!0},e.prototype.filterValue=function(t){for(var e=0;e<this.operands.length;e+=1)if(!this.operands[e].filterValue(t))return!1;return!0},e.prototype.and=function(t){var r=[];return Array.prototype.push.apply(r,this.operands),t instanceof e?Array.prototype.push.apply(r,t.operands):r.push(t.asFilter()),new e(r)},e.prototype.andThen=function(t){return new e(this.operands,this.then.andThen(t))},e.prototype.equals=function(t){if(t instanceof e){var r=this.operands.length;if(r===t.operands.length){for(var i=0;i<r;i+=1)if(!this.operands[i].equals(t.operands[i]))return!1;return this.then.equals(t.then)}}return!1},e}(Dt),St=function(t){function e(e,r){var i=t.call(this,r)||this;return i.operand=e,i}return r(e,t),e.prototype.filterField=function(t){return!this.operand.filterField(t)},e.prototype.filterValue=function(t){return!this.operand.filterValue(t)},e.prototype.not=function(){return this.operand},e.prototype.andThen=function(t){return new e(this.operand,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.operand.equals(t.operand)&&this.then.equals(t.then))},e}(Dt),Vt=function(t){function e(e,r,i){var n=t.call(this,i)||this;return n.selector=e,n.value=r,n}return r(e,t),e.prototype.filterValue=function(t){return null===this.selector.forEachValue(t,this.selected,this,[])},e.prototype.selected=function(t,e,r){return!!this.filterOp(t,this.value)&&null},e}(Dt),At=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return r(e,t),e.prototype.filterOp=function(t,e){return x(t,e)<0},e.prototype.andThen=function(t){return new e(this.selector,this.value,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&E(this.value,t.value)&&this.then.equals(t.then))},e}(Vt),Ft=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return r(e,t),e.prototype.filterOp=function(t,e){return x(t,e)<=0},e.prototype.andThen=function(t){return new e(this.selector,this.value,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&E(this.value,t.value)&&this.then.equals(t.then))},e}(Vt),zt=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return r(e,t),e.prototype.filterOp=function(t,e){return E(t,e)},e.prototype.andThen=function(t){return new e(this.selector,this.value,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&E(this.value,t.value)&&this.then.equals(t.then))},e}(Vt),qt=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return r(e,t),e.prototype.filterOp=function(t,e){return!E(t,e)},e.prototype.andThen=function(t){return new e(this.selector,this.value,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&E(this.value,t.value)&&this.then.equals(t.then))},e}(Vt),It=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return r(e,t),e.prototype.filterOp=function(t,e){return x(t,e)>=0},e.prototype.andThen=function(t){return new e(this.selector,this.value,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&E(this.value,t.value)&&this.then.equals(t.then))},e}(Vt),$t=function(t){function e(e,r,i){return t.call(this,e,r,i)||this}return r(e,t),e.prototype.filterOp=function(t,e){return x(t,e)>0},e.prototype.andThen=function(t){return new e(this.selector,this.value,this.then.andThen(t))},e.prototype.equals=function(t){return t instanceof e&&(this.selector.equals(t.selector)&&E(this.value,t.value)&&this.then.equals(t.then))},e}(Vt),Bt=new gt,Tt=new Et,Ot=new xt,Ut=new bt,Ht=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.selector=e,o.keyParser=r,o.filterParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.selector,this.keyParser,this.filterParser,this.step)},e.parse=function(t,r,i,n,o){void 0===r&&(r=Bt),void 0===o&&(o=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.done(r);break}if(64===s||123===s||b(s)||36===s||34===s||39===s||45===s||s>=48&&s<=57||37===s)o=2;else if(35===s)t.step(),o=3;else if(47===s)t.step(),o=5;else if(58===s)t.step(),r=r.keys();else{if(91!==s)return X.done(r);t.step(),o=6}}if(2===o){for(i||(i=Lt.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(!i.isDone()){if(i.isError())return i.asError();break}r=r.get(i.bind()),i=void 0,o=4}if(3===o){for(i||(i=ht.parseInteger(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(!i.isDone()){if(i.isError())return i.asError();break}r=r.getIndex(i.bind()),i=void 0,o=4}if(4===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.done(r);break}if(46===s){t.step(),o=2;continue}if(35===s){t.step(),o=3;continue}if(47===s)t.step(),o=5;else{if(91!==s)return X.done(r);t.step(),o=6}}if(5!==o){if(6===o){for(n||(n=jt.parse(t));(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}o=7}if(7===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.unexpected(t);break}if(93!==s)return X.expected("]",t);t.step();var u=n.bind();r=r.andThen(u),n=void 0,o=8}if(8===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return X.done(r);break}if(46===s){t.step(),o=2;continue}if(35===s){t.step(),o=3;continue}if(47===s){t.step(),o=5;continue}return X.done(r)}}else{if(t.isEmpty()){if(t.isDone())return r=r.children(),X.done(r);break}47===(s=t.head())?(t.step(),r=r.descendants()):r=r.children(),o=1}}return new e(r,i,n,o)},e}(X),jt=function(t){function e(e,r,i){var n=t.call(this)||this;return n.lhsParser=e,n.rhsParser=r,n.step=i,n}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n){for(r||(r=Mt.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())n=2;else if(r.isError())return r.asError()}if(2===n){for(;!t.isEmpty()&&(o=t.head(),X.isSpace(o));)t.step();if(t.isEmpty()){if(t.isDone())return r}else{if(124!==o)return r;t.step(),n=3}}if(3===n){for(i||(i=e.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone()){var s=r.bind(),u=i.bind();return X.done(s.or(u))}if(i.isError())return i.asError()}return new e(r,i,n)},e}(X),Mt=function(t){function e(e,r,i){var n=t.call(this)||this;return n.lhsParser=e,n.rhsParser=r,n.step=i,n}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n){for(r||(r=Rt.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())n=2;else if(r.isError())return r.asError()}if(2===n){for(;!t.isEmpty()&&(o=t.head(),X.isSpace(o));)t.step();if(t.isEmpty()){if(t.isDone())return r}else{if(38!==o)return r;t.step(),n=3}}if(3===n){for(i||(i=e.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone()){var s=r.bind(),u=i.bind();return X.done(s.and(u))}if(i.isError())return i.asError()}return new e(r,i,n)},e}(X),Rt=function(t){function e(e,r,i){var n=t.call(this)||this;return n.operator=e,n.operandParser=r,n.step=i,n}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.operator,this.operandParser,this.step)},e.parse=function(t,r,i,n){void 0===n&&(n=1);var o=0;if(1===n){for(;!t.isEmpty()&&(o=t.head(),X.isSpace(o));)t.step();t.isEmpty()?t.isDone()&&(n=2):(33===o?(t.step(),r="!",i=e.parse(t)):i=Nt.parse(t),n=2)}if(2===n){for(i=i;(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone()){var s=i.bind();return"!"===r&&(s=s.not()),X.done(s)}if(i.isError())return i.asError()}return new e(r,i,n)},e}(X),Nt=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.lhsParser=e,o.operator=r,o.rhsParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o){for(r||(r=Kt.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())o=2;else if(r.isError())return r.asError()}if(2===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone()){u=r.bind();return X.done(u.asFilter())}}else if(33===s)t.step(),o=3;else if(60===s)t.step(),o=4;else if(62===s)t.step(),o=5;else{if(61!==s){var u=r.bind();return X.done(u.asFilter())}t.step(),i="=",o=6}}if(3===o)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else 61===(s=t.head())?(t.step(),i="!=",o=6):(i="!",o=6);if(4===o)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else 61===(s=t.head())?(t.step(),i="<=",o=6):(i="<",o=6);if(5===o)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else 61===(s=t.head())?(t.step(),i=">=",o=6):(i=">",o=6);if(6===o){for(;!t.isEmpty()&&(s=t.head(),X.isSpace(s));)t.step();t.isEmpty()||(n=it.parse(t),o=7)}if(7===o){for(n=n;(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(n.isDone()){var p=r.bind(),a=n.bind();return X.done(p.op(i,a))}if(n.isError())return n.asError()}return new e(r,i,n,o)},e}(X),Kt=function(t){function e(e,r){var i=t.call(this)||this;return i.operandParser=e,i.step=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.operandParser,this.step)},e.parse=function(t,r,i){void 0===i&&(i=1);var n=0;if(1===i){for(;!t.isEmpty()&&(n=t.head(),X.isSpace(n));)t.step();t.isEmpty()?t.isDone()&&(i=2):40===n?(t.step(),i=3):i=2}if(2===i){for(r||(r=Ht.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())return r;if(r.isError())return r.asError()}if(3===i){for(r||(r=jt.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())i=4;else if(r.isError())return r.asError()}if(4===i){for(;!t.isEmpty()&&(n=t.head(),X.isSpace(n));)t.step();if(!t.isEmpty())return 41===n?(t.step(),r):X.expected(")",t);if(t.isDone())return X.unexpected(t)}return new e(r,i)},e}(X),Lt=function(t){function e(e,r){var i=t.call(this)||this;return i.keyParser=e,i.step=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.keyParser,this.step)},e.parse=function(t,r,i){void 0===i&&(i=1);var n=0;if(1===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else if(64===(n=t.head()))t.step(),i=2;else if(123===n)r=ot.parse(t,new Q),i=3;else if(b(n))r=pt.parse(t),i=3;else if(36===n){t.step();(o=new N).write(36),r=pt.parse(t,o),i=3}else if(34===n||39===n)r=at.parse(t),i=3;else if(45===n||n>=48&&n<=57)r=ht.parse(t),i=3;else{if(37!==n)return X.expected("select key",t);r=ut.parse(t),i=3}if(2===i)if(t.isEmpty()){if(t.isDone())return X.unexpected(t)}else{var o=new N;if(o.write(64),34===(n=t.head())||39===n)r=at.parse(t,o);else{if(!b(n))return X.expected("attribute name",t);r=pt.parse(t,o)}i=3}if(3===i){for(r=r;(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())return r;if(r.isError())return r.asError()}return new e(r,i)},e}(X),Qt=function(){function t(){}return t.prototype.constant=function(){return K},t.prototype.join=function(t){var e=[this];return t instanceof Jt?Array.prototype.push.apply(e,t.parts):e.push(t),new Jt(e)},t.identity=function(){return Gt},t.literal=function(t){return new Wt(t)},t.selector=function(t){return new _t(t)},t.parse=function(t){var e=new M(t),r=Xt.parse(e);return r.isDone()&&!e.isEmpty()&&(r=X.unexpected(e)),r.bind()},t}(),Wt=function(t){function e(e){var r=t.call(this)||this;return r.value=e,r}return r(e,t),e.prototype.interpolateField=function(t,e){return this.value},e.prototype.interpolateValue=function(t,e){return this.value},e.prototype.interpolateForEach=function(t){return this.value},e.prototype.constant=function(){return this.value},e.prototype.equals=function(t){return t instanceof e&&E(this.value,t.value)},e}(Qt),_t=function(t){function e(e){var r=t.call(this)||this;return r.selector=e,r}return r(e,t),e.prototype.interpolateField=function(t,e){return this.selector.select(t,!0)},e.prototype.interpolateValue=function(t,e){return this.selector.select(t,!1)},e.prototype.interpolateForEach=function(t){return t(this.selector)},e.prototype.equals=function(t){return t instanceof e&&this.selector.equals(t.selector)},e}(Qt),Jt=function(t){function e(e){var r=t.call(this)||this;return r.parts=e,r}return r(e,t),e.prototype.interpolateField=function(t,e){e=e||[];for(var r="",i=0;i<this.parts.length;i+=1){var n=this.parts[i].interpolateField(t,e);"string"!=typeof n&&(n=k(n)),r+=n}return r},e.prototype.interpolateValue=function(t,e){e=e||[];for(var r="",i=0;i<this.parts.length;i+=1){var n=this.parts[i].interpolateValue(t,e);"string"!=typeof n&&(n=k(n)),r+=n}return r},e.prototype.interpolateForEach=function(t){for(var e="",r=0;r<this.parts.length;r+=1){var i=this.parts[r].interpolateForEach(t);if(void 0===i)return;"string"!=typeof i&&(i=k(i)),e+=i}return e},e.prototype.constant=function(){for(var t="",e=0;e<this.parts.length;e+=1){var r=this.parts[e].constant();if(void 0===r)return;"string"!=typeof r&&(r=k(r)),t+=r}return t},e.prototype.join=function(t){var r=[];return Array.prototype.push.apply(r,this.parts),t instanceof e?Array.prototype.push.apply(r,t.parts):r.push(t),new e(r)},e.prototype.equals=function(t){if(t instanceof e){var r=this.parts.length;if(r===t.parts.length){for(var i=0;i<r;i+=1)if(!this.parts[i].equals(t.parts[i]))return!1;return!0}}return!1},e}(Qt),Gt=new _t(vt.identity()),Xt=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.parts=e,o.literalOutput=r,o.selectorParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.parts,this.literalOutput,this.selectorParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;t:for(;!t.isEmpty()||t.isDone();){if(1===o){if(s=t.head(),t.isEmpty()){if(t.isDone())return r=r||[],n&&(r.push(new _t(n.bind())),n=void 0),r.length>1?X.done(new Jt(r)):1===r.length?X.done(r[0]):X.done(new Wt(""));break}123===s?(t.step(),o=2):(n&&((r=r||[]).push(new _t(n.bind())),n=void 0),o=6)}if(2===o)if(s=t.head(),t.isEmpty()){if(!t.isDone())break;i||(i=new N),i.write(123),o=6}else 123===s?(i&&((r=r||[]).push(new Wt(i.get())),i=void 0),t.step(),o=3):(i||(i=new N),i.write(123),o=6);if(3===o){for(n||(n=Ht.parse(t));(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(!n.isDone()){if(n.isError())return n.asError();break}o=4}if(4===o){if(s=t.head(),t.isEmpty()){if(t.isDone())return X.expected("}",t);break}if(125!==s)return X.expected("}",t);t.step(),o=5}if(5===o){if(s=t.head(),t.isEmpty()){if(t.isDone())return X.expected("}",t);break}if(125===s){t.step(),o=1;continue}return X.expected("}",t)}if(6===o){for(;!t.isEmpty();){if(123===(s=t.head())){t.step(),o=2;continue t}t.step(),i||(i=new N),i.write(s)}if(t.isDone()){(r=r||[]).push(new Wt(i.get())),i=void 0,o=1;continue}break}}return new e(r,i,n,o)},e}(X),Yt=function(){return function(){}}(),Zt=function(t){function e(e,r){void 0===r&&(r=0);var i=t.call(this)||this;return i.slots=e,i.index=r,i}return r(e,t),e.prototype.skipNext=function(t){this.index=Math.min(this.index+t,this.slots.length)},e.prototype.hasNext=function(){return this.index<this.slots.length},e.prototype.nextIndex=function(){return this.index},e.prototype.next=function(){var t=this.index;return t<this.slots.length?(this.index=t+1,{value:this.slots[t],done:this.index===this.slots.length}):(this.index=this.slots.length,{done:!0})},e.prototype.hasPrevious=function(){return this.index>0},e.prototype.previousIndex=function(){return this.index-1},e.prototype.previous=function(){var t=this.index-1;return t>=0?(this.index=t,{value:this.slots[t],done:0===t}):(this.index=0,{done:!0})},e}(Yt),te=function(t){function e(e,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this)||this;return o.pages=e,o.index=r,o.pageIndex=i,o.subCursor=n,o}return r(e,t),e.prototype.skipNext=function(t){for(;t>0;)if(this.subCursor)this.subCursor.hasNext()?(this.index+=1,t-=1,this.subCursor.next()):this.subCursor=void 0;else{if(!(this.pageIndex<this.pages.length))break;var e=this.pages[this.pageIndex],r=this.pageSize(e);if(this.pageIndex+=1,r<t){this.subCursor=this.pageCursor(e),t>0&&(this.index+=t,this.subCursor.skipNext(t),t=0);break}this.index+=r,t-=r}},e.prototype.hasNext=function(){for(;;)if(this.subCursor){if(this.subCursor.hasNext())return!0;this.subCursor=void 0}else{if(!(this.pageIndex<this.pages.length))return this.pageIndex=this.pages.length,!1;this.subCursor=this.pageCursor(this.pages[this.pageIndex]),this.pageIndex+=1}},e.prototype.nextIndex=function(){return this.index},e.prototype.next=function(){for(;;)if(this.subCursor){if(this.subCursor.hasNext())return this.index+=1,this.subCursor.next();this.subCursor=void 0}else{if(!(this.pageIndex<this.pages.length))return this.pageIndex=this.pages.length,{done:!0};this.subCursor=this.pageCursor(this.pages[this.pageIndex]),this.pageIndex+=1}},e.prototype.hasPrevious=function(){for(;;)if(this.subCursor){if(this.subCursor.hasPrevious())return!0;this.subCursor=void 0}else{if(!(this.pageIndex>0))return this.pageIndex=0,!1;this.subCursor=this.reversePageCursor(this.pages[this.pageIndex-1]),this.pageIndex-=1}},e.prototype.previousIndex=function(){return this.index-1},e.prototype.previous=function(){for(;;)if(this.subCursor){if(this.subCursor.hasPrevious())return this.index-=1,this.subCursor.previous();this.subCursor=void 0}else{if(!(this.pageIndex>0))return this.pageIndex=0,{done:!0};this.subCursor=this.reversePageCursor(this.pages[this.pageIndex-1]),this.pageIndex-=1}},e}(Yt),ee=function(t){function e(e){var r=t.call(this)||this;return r.cursor=e,r}return r(e,t),e.prototype.skipNext=function(t){this.cursor.skipNext(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,r=t.done;return{value:e&&e[0],done:r}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.next(),e=t.value,r=t.done;return{value:e&&e[0],done:r}},e}(Yt),re=function(t){function e(e){var r=t.call(this)||this;return r.cursor=e,r}return r(e,t),e.prototype.skipNext=function(t){this.cursor.skipNext(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,r=t.done;return{value:e&&e[1],done:r}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.next(),e=t.value,r=t.done;return{value:e&&e[1],done:r}},e}(Yt),ie=function(){function t(t){void 0===t&&(t=ne.empty()),this.root=t}return Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.root.isEmpty()},t.prototype.has=function(t){return this.root.has(t,this)},t.prototype.get=function(t){return this.root.get(t,this)},t.prototype.getEntry=function(t){return this.root.getEntry(t)},t.prototype.firstKey=function(){var t=this.root.firstEntry();return t?t[0]:void 0},t.prototype.firstValue=function(){var t=this.root.firstEntry();return t?t[1]:void 0},t.prototype.firstEntry=function(){return this.root.firstEntry()},t.prototype.lastKey=function(){var t=this.root.lastEntry();return t?t[0]:void 0},t.prototype.lastValue=function(){var t=this.root.lastEntry();return t?t[1]:void 0},t.prototype.lastEntry=function(){return this.root.lastEntry()},t.prototype.nextKey=function(t){var e=this.root.nextEntry(t,this);return e?e[0]:void 0},t.prototype.nextValue=function(t){var e=this.root.nextEntry(t,this);return e?e[1]:void 0},t.prototype.nextEntry=function(t){return this.root.nextEntry(t,this)},t.prototype.previousKey=function(t){var e=this.root.previousEntry(t,this);return e?e[0]:void 0},t.prototype.previousValue=function(t){var e=this.root.previousEntry(t,this);return e?e[1]:void 0},t.prototype.previousEntry=function(t){return this.root.previousEntry(t,this)},t.prototype.set=function(t,e){var r=this.root,i=this.root.updated(t,e,this);return r!==i&&(i.size>r.size&&(i=i.balanced(this)),this.root=i),this},t.prototype.delete=function(t){var e=this.root,r=this.root.removed(t,this);return e!==r&&(this.root=r,!0)},t.prototype.drop=function(t){return t>0&&this.root.size>0&&(t<this.root.size?this.root=this.root.drop(t,this):this.root=ne.empty()),this},t.prototype.take=function(t){return t<this.root.size&&this.root.size>0&&(this.root=t>0?this.root.take(t,this):ne.empty()),this},t.prototype.clear=function(){this.root=ne.empty()},t.prototype.updated=function(t,e){var r=this.root,i=r.updated(t,e,this);return r!==i?(i.size>r.size&&(i=i.balanced(this)),this.copy(i)):this},t.prototype.removed=function(t){var e=this.root,r=e.removed(t,this);return e!==r?this.copy(r):this},t.prototype.cleared=function(){return this.root.isEmpty()?this:this.copy(ne.empty())},t.prototype.forEach=function(t,e){this.root.forEach(t,e,this)},t.prototype.keys=function(){return this.root.keys()},t.prototype.values=function(){return this.root.values()},t.prototype.entries=function(){return this.root.entries()},t.prototype.reverseKeys=function(){return this.root.reverseKeys()},t.prototype.reverseValues=function(){return this.root.reverseValues()},t.prototype.reverseEntries=function(){return this.root.reverseEntries()},t.prototype.clone=function(){return this.copy(this.root)},t.prototype.copy=function(e){var r=new t(e);return r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},t.prototype.toValue=function(){return this.root.toValue()},t.prototype.toRecon=function(){return k(this.toValue())},t.prototype.compare=function(t,e){return x(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t}();ie.prototype.pageSplitSize=32;var ne=function(){function t(){}return t.prototype.keys=function(){return new ee(this.entries())},t.prototype.values=function(){return new re(this.entries())},t.prototype.reverseKeys=function(){return new ee(this.reverseEntries())},t.prototype.reverseValues=function(){return new re(this.reverseEntries())},t.prototype.toRecon=function(){return k(this.toValue())},t.empty=function(){return pe},t}(),oe=function(t){function e(e){var r=t.call(this)||this;return r.slots=e,r}return r(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.slots.length},e.prototype.minKey=function(){return this.slots[0][0]},e.prototype.maxKey=function(){return this.slots[this.slots.length-1][0]},e.prototype.has=function(t,e){return this.lookup(t,e)>=0},e.prototype.get=function(t,e){var r=this.lookup(t,e);return r>=0?this.slots[r][1]:void 0},e.prototype.getEntry=function(t){return this.slots[t]},e.prototype.firstEntry=function(){return this.slots.length?this.slots[0]:void 0},e.prototype.lastEntry=function(){return this.slots.length?this.slots[this.slots.length-1]:void 0},e.prototype.nextEntry=function(t,e){var r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this.slots[r]},e.prototype.previousEntry=function(t,e){var r=this.lookup(t,e);return r>=0?r-=1:r=-(r+2),this.slots[r]},e.prototype.updated=function(t,e,r){var i=this.lookup(t,r);return i>=0?this.updatedSlot(i,t,e):(i=-(i+1),this.insertedSlot(i,t,e))},e.prototype.updatedSlot=function(t,r,i){var n=this.slots;if(i!==n[t][1]){var o=n.slice(0);return o[t]=[r,i],new e(o)}return this},e.prototype.insertedSlot=function(t,r,i){for(var n=this.slots,o=new Array(n.length+1),s=0;s<t;s+=1)o[s]=n[s];o[t]=[r,i];for(s=t;s<n.length;s+=1)o[s+1]=n[s];return new e(o)},e.prototype.removed=function(t,e){var r=this.lookup(t,e);return r>=0?this.slots.length>1?this.removedSlot(r):ne.empty():this},e.prototype.removedSlot=function(t){for(var r=this.slots,i=new Array(r.length-1),n=0;n<t;n+=1)i[n]=r[n];for(n=t;n<i.length;n+=1)i[n]=r[n+1];return new e(i)},e.prototype.drop=function(t,r){var i=this.slots;if(t>0&&i.length>0){if(t<i.length){for(var n=i.length-t,o=new Array(n),s=0;s<n;s+=1)o[s]=i[s+t];return new e(o)}return ne.empty()}return this},e.prototype.take=function(t,r){var i=this.slots;if(t<i.length&&i.length>0){if(t>0){for(var n=new Array(t),o=0;o<t;o+=1)n[o]=i[o];return new e(n)}return ne.empty()}return this},e.prototype.balanced=function(t){var e=this.slots.length;return e>1&&t.pageShouldSplit(this)?this.split(e>>>1):this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;var n=new Array(1);return n[0]=i.minKey(),new se(e,n,this.slots.length)},e.prototype.splitLeft=function(t){for(var r=this.slots,i=new Array(t),n=0;n<t;n+=1)i[n]=r[n];return new e(i)},e.prototype.splitRight=function(t){for(var r=this.slots,i=r.length-t,n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+t];return new e(n)},e.prototype.forEach=function(t,e,r){for(var i=0;i<this.slots.length;i+=1){var n=this.slots[i];t.call(e,n[0],n[1],r)}},e.prototype.entries=function(){return new Zt(this.slots)},e.prototype.reverseEntries=function(){return new Zt(this.slots,this.slots.length)},e.prototype.toValue=function(){var t=new L;t.appendField("@bleaf",{size:this.slots.length});for(var e=0;e<this.slots.length;e+=1){var r=this.slots[e];t.appendField(r[0],r[1])}return t.get()},e.prototype.lookup=function(t,e){for(var r=0,i=this.slots.length-1;r<=i;){var n=r+i>>>1,o=e.compare(t,this.slots[n][0]);if(o>0)r=n+1;else{if(!(o<0))return n;i=n-1}}return-(r+1)},e}(ne),se=function(t){function e(e,r,i){var n=t.call(this)||this;return n.pages=e,n.knots=r,n.size=i,n}return r(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.pages.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.size},e.prototype.minKey=function(){return this.pages[0].minKey()},e.prototype.maxKey=function(){return this.pages[this.pages.length-1].maxKey()},e.prototype.has=function(t,e){var r=this.lookup(t,e);if(r>0)r+=1;else{if(!(r<0))return!0;r=-(r+1)}return this.pages[r].has(t,e)},e.prototype.get=function(t,e){var r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this.pages[r].get(t,e)},e.prototype.getEntry=function(t){for(var e=0;e<this.pages.length;e+=1){var r=this.pages[e];if(t<r.size)return r.getEntry(t);t-=r.size}},e.prototype.firstEntry=function(){return this.pages.length?this.pages[0].firstEntry():void 0},e.prototype.lastEntry=function(){return this.pages.length?this.pages[this.pages.length-1].lastEntry():void 0},e.prototype.nextEntry=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var i=this.pages[r].nextEntry(t,e);return void 0===i&&r+1<this.pages.length&&(i=this.pages[r+1].nextEntry(t,e)),i},e.prototype.previousEntry=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var i=this.pages[r].previousEntry(t,e);return void 0===i&&r>0&&(i=this.pages[r-1].previousEntry(t,e)),i},e.prototype.updated=function(t,e,r){var i=this.lookup(t,r);i>=0?i+=1:i=-(i+1);var n=this.pages[i],o=n.updated(t,e,r);return n!==o?n.size!==o.size&&r.pageShouldSplit(o)?this.updatedPageSplit(i,o,n):this.updatedPage(i,o,n):this},e.prototype.updatedPage=function(t,r,i){var n=this.pages.slice(0);n[t]=r;var o,s=this.knots;s.length>0?(o=s.slice(0),t>0&&(o[t-1]=r.minKey())):o=[];return new e(n,o,this.size-i.size+r.size)},e.prototype.updatedPageSplit=function(t,r,i){for(var n=this.pages,o=new Array(n.length+1),s=0;s<t;s+=1)o[s]=n[s];var u=r.splitLeft(r.arity>>>1),p=r.splitRight(r.arity>>>1);o[t]=u,o[t+1]=p;for(s=t+1;s<n.length;s+=1)o[s+1]=n[s];var a=this.knots,h=new Array(n.length);if(t>0){for(s=0;s<t-1;s+=1)h[s]=a[s];h[t-1]=u.minKey(),h[t]=p.minKey();for(s=t;s<a.length;s+=1)h[s+1]=a[s]}else{h[0]=p.minKey();for(s=0;s<a.length;s+=1)h[s+1]=a[s]}return new e(o,h,this.size-i.size+r.size)},e.prototype.updatedPageMerge=function(t,r,i){for(var n=this.pages,o=r.pages,s=new Array(n.length+o.length-1),u=0;u<t;u+=1)s[u]=n[u];for(u=0;u<o.length;u+=1)s[u+t]=o[u];for(u=t+1;u<n.length;u+=1)s[u+o.length-1]=n[u];var p=this.knots,a=r.knots,h=new Array(s.length-1);if(t>0){for(u=0;u<t-1;u+=1)h[u]=p[u];h[t-1]=o[0].minKey();for(u=0;u<a.length;u+=1)h[u+t]=a[u];for(u=t;u<p.length;u+=1)h[u+a.length]=p[u]}else{for(u=0;u<a.length;u+=1)h[u]=a[u];h[a.length]=n[1].minKey();for(u=1;u<p.length;u+=1)h[u+a.length]=p[u]}return new e(s,h,this.size-i.size+r.size)},e.prototype.removed=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var i=this.pages[r],n=i.removed(t,e);return i!==n?this.replacedPage(r,n,i,e):this},e.prototype.replacedPage=function(t,r,i,n){return r.isEmpty()?this.pages.length>2?this.removedPage(t,r,i):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:ne.empty():r instanceof e&&n.pageShouldMerge(r)?this.updatedPageMerge(t,r,i):this.updatedPage(t,r,i)},e.prototype.removedPage=function(t,r,i){for(var n=this.pages,o=new Array(n.length-1),s=0;s<t;s+=1)o[s]=n[s];for(s=t+1;s<n.length;s+=1)o[s-1]=n[s];var u=this.knots,p=new Array(u.length-1);if(t>0){for(s=0;s<t-1;s+=1)p[s]=u[s];for(s=t;s<u.length;s+=1)p[s-1]=u[s]}else for(s=1;s<u.length;s+=1)p[s-1]=u[s];return new e(o,p,this.size-i.size)},e.prototype.drop=function(t,r){if(t>0){var i=this.size;if(t<i){for(var n=this.pages,o=0;o<n.length;){var s=n[o].size;if(!(s<=t))break;i-=s,t-=s,o+=1}var u=n.length-o;if(u>1){var p=void 0;if(o>0){for(var a=new Array(u),h=0;h<u;h+=1)a[h]=n[h+o];for(var f=new Array(u-1),h=0;h<f.length;h+=1)f[h]=this.knots[h+o];p=new e(a,f,i)}else p=this;if(t>0){var d=n[o],c=d.drop(t,r);return p.replacedPage(0,c,d,r)}return p}return n[o].drop(t,r)}return ne.empty()}return this},e.prototype.take=function(t,r){if(t<this.size){if(t>0){for(var i=this.pages,n=0,o=0;o<i.length&&t>0;){var s=i[o].size;if(n+=s,o+=1,!(s<=t))break;t-=s}var u=0===t?o:o+1;if(u>1){var p=void 0;if(o<i.length){for(var a=new Array(u),h=0;h<u;h+=1)a[h]=i[h];for(var f=new Array(u-1),h=0;h<f.length;h+=1)f[h]=this.knots[h];p=new e(a,f,n)}else p=this;if(t>0){var d=i[o-1],c=d.take(t,r);return p.replacedPage(o-1,c,d,r)}return p}return t>0?i[0].take(t,r):i[0]}return ne.empty()}return this},e.prototype.balanced=function(t){return this.pages.length>1&&t.pageShouldSplit(this)?this.split(this.knots.length>>>1):this},e.prototype.split=function(t){var r=new Array(2),i=this.splitLeft(t),n=this.splitRight(t);r[0]=i,r[1]=n;var o=new Array(1);return o[0]=n.minKey(),new e(r,o,this.size)},e.prototype.splitLeft=function(t){for(var r=this.pages,i=new Array(t+1),n=0;n<t+1;n+=1)i[n]=r[n];for(var o=this.knots,s=new Array(t),n=0;n<t;n+=1)s[n]=o[n];for(var u=0,n=0;n<=t;n+=1)u+=i[n].size;return new e(i,s,u)},e.prototype.splitRight=function(t){for(var r=this.pages,i=r.length-(t+1),n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+(t+1)];for(var s=this.knots,u=new Array(i-1),o=0;o<u.length;o+=1)u[o]=s[o+(t+1)];for(var p=0,o=0;o<i;o+=1)p+=n[o].size;return new e(n,u,p)},e.prototype.forEach=function(t,e,r){for(var i=0;i<this.pages.length;i+=1)this.pages[i].forEach(t,e,r)},e.prototype.entries=function(){return new ue(this.pages)},e.prototype.reverseEntries=function(){return new ue(this.pages,this.size,this.pages.length)},e.prototype.toValue=function(){var t=new L;t.appendField("@bnode",{size:this.size});for(var e=0;e<this.pages.length;e+=1)e>0&&t.appendValue({"@knot":{key:this.knots[e-1]}}),t.appendValue(this.pages[e].toValue());return t.get()},e.prototype.lookup=function(t,e){for(var r=0,i=this.knots.length-1;r<=i;){var n=r+i>>>1,o=e.compare(t,this.knots[n]);if(o>0)r=n+1;else{if(!(o<0))return n;i=n-1}}return-(r+1)},e}(ne),ue=function(t){function e(e,r,i,n){return t.call(this,e,r,i,n)||this}return r(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(te),pe=new oe([]),ae=function(){function t(t){void 0===t&&(t=he.empty()),this.root=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.root.isEmpty()},t.prototype.get=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.get(t)},t.prototype.getEntry=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.getEntry(t)},t.prototype.set=function(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);if(t<0||t>=this.root.size)throw new RangeError(""+t);return this.root=this.root.updated(t,e,this),this},t.prototype.insert=function(t,e,r){if(t<0||t>this.root.size)throw new RangeError(""+t);return this.root=this.root.inserted(t,e,r,this).balanced(this),this},t.prototype.remove=function(t,e){if(void 0!==e&&(t=this.lookup(e,t))<0)throw new RangeError(""+e);if(t<0||t>this.root.size)throw new RangeError(""+t);return this.root=this.root.removed(t,this),this},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r+=1)this.root=this.root.inserted(this.root.size,t[r],void 0,this).balanced(this);return this.root.size},t.prototype.pop=function(){var t=this.root.size-1;if(t>=0){var e=this.root.get(t);return this.root=this.root.removed(t,this),e}},t.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1;r>=0;r-=1)this.root=this.root.inserted(0,t[r],void 0,this).balanced(this);return this.root.size},t.prototype.shift=function(){if(this.root.size>0){var t=this.root.get(0);return this.root=this.root.removed(0,this),t}},t.prototype.move=function(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);if(t<0||t>=this.root.size)throw new RangeError(""+t);if(e<0||e>=this.root.size)throw new RangeError(""+e);if(t!==e){var i=this.root.getEntry(t);this.root=this.root.removed(t,this).inserted(e,i[1],i[0],this).balanced(this)}return this},t.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];t<0&&(t=this.root.size+t),t=Math.min(Math.max(0,t),this.root.size),void 0===e&&(e=this.root.size-t);for(var n=[],o=t,s=t+e;o<s;o+=1)n.push(this.root.get(t)),this.root=this.root.removed(t,this);for(o=0;o<r.length;o+=1)this.root=this.root.inserted(t+o,r[o],void 0,this).balanced(this);return n},t.prototype.drop=function(t){return t>0&&this.root.size>0&&(t<this.root.size?this.root=this.root.drop(t,this):this.root=he.empty()),this},t.prototype.take=function(t){return t<this.root.size&&this.root.size>0&&(this.root=t>0?this.root.take(t,this):he.empty()),this},t.prototype.clear=function(){this.root=he.empty()},t.prototype.forEach=function(t,e){this.root.forEach(t,e,0,this)},t.prototype.keys=function(){return this.root.keys()},t.prototype.values=function(){return this.root.values()},t.prototype.entries=function(){return this.root.entries()},t.prototype.reverseKeys=function(){return this.root.reverseKeys()},t.prototype.reverseValues=function(){return this.root.reverseValues()},t.prototype.reverseEntries=function(){return this.root.reverseEntries()},t.prototype.clone=function(){return this.copy(this.root)},t.prototype.copy=function(e){var r=new t(e);return r.identify!==this.identify&&(r.identify=this.identify),r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},t.prototype.toValue=function(){return this.root.toValue()},t.prototype.toRecon=function(){return k(this.toValue())},t.prototype.identify=function(t){var e=new Uint8Array(6);return yt(e),e},t.prototype.compare=function(t,e){return x(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t.prototype.lookup=function(t,e){void 0===e&&(e=0);var r=e=Math.min(Math.max(0,e),this.root.size-1);do{var i=this.root.getEntry(r);if(i&&0===this.compare(i[0],t))return r;r=(r+1)%this.root.size}while(isFinite(r)&&r!==e);return-1},t}();ae.prototype.pageSplitSize=32;var he=function(){function t(){}return t.prototype.keys=function(){return new ee(this.entries())},t.prototype.values=function(){return new re(this.entries())},t.prototype.reverseKeys=function(){return new ee(this.reverseEntries())},t.prototype.reverseValues=function(){return new re(this.reverseEntries())},t.prototype.toRecon=function(){return k(this.toValue())},t.empty=function(){return le},t}(),fe=function(t){function e(e){var r=t.call(this)||this;return r.slots=e,r}return r(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.slots.length},e.prototype.get=function(t){var e=this.slots[t];return e?e[1]:void 0},e.prototype.getEntry=function(t){return this.slots[t]},e.prototype.updated=function(t,e,r){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.updatedItem(t,e)},e.prototype.updatedItem=function(t,r){var i=this.slots,n=i[t];if(r!==n[1]){var o=i.slice(0);return o[t]=[n[0],r],new e(o)}return this},e.prototype.inserted=function(t,e,r,i){if(t<0||t>this.slots.length)throw new RangeError(""+t);return this.insertedItem(t,e,r,i)},e.prototype.insertedItem=function(t,r,i,n){void 0===i&&(i=n.identify(r));for(var o=this.slots,s=new Array(o.length+1),u=0;u<t;u+=1)s[u]=o[u];s[t]=[i,r];for(u=t;u<o.length;u+=1)s[u+1]=o[u];return new e(s)},e.prototype.removed=function(t,e){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.slots.length>1?this.removedSlot(t):he.empty()},e.prototype.removedSlot=function(t){for(var r=this.slots,i=new Array(r.length-1),n=0;n<t;n+=1)i[n]=r[n];for(n=t;n<i.length;n+=1)i[n]=r[n+1];return new e(i)},e.prototype.drop=function(t,r){var i=this.slots;if(t>0&&i.length>0){if(t<i.length){for(var n=i.length-t,o=new Array(n),s=0;s<n;s+=1)o[s]=i[s+t];return new e(o)}return he.empty()}return this},e.prototype.take=function(t,r){var i=this.slots;if(t<i.length&&i.length>0){if(t>0){for(var n=new Array(t),o=0;o<t;o+=1)n[o]=i[o];return new e(n)}return he.empty()}return this},e.prototype.balanced=function(t){var e=this.slots.length;return e>1&&t.pageShouldSplit(this)?this.split(e>>>1):this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),i=this.splitRight(t);e[0]=r,e[1]=i;var n=new Array(1);return n[0]=t,new de(e,n,this.slots.length)},e.prototype.splitLeft=function(t){for(var r=this.slots,i=new Array(t),n=0;n<t;n+=1)i[n]=r[n];return new e(i)},e.prototype.splitRight=function(t){for(var r=this.slots,i=r.length-t,n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+t];return new e(n)},e.prototype.forEach=function(t,e,r,i){for(var n=0;n<this.slots.length;n+=1){var o=this.slots[n];t.call(e,o[1],r+n,i,o[0])}},e.prototype.entries=function(){return new Zt(this.slots)},e.prototype.reverseEntries=function(){return new Zt(this.slots,this.slots.length)},e.prototype.toValue=function(){var t=new L;t.appendField("@sleaf",{size:this.slots.length});for(var e=0;e<this.slots.length;e+=1){var r=this.slots[e];t.appendField(r[0],r[1])}return t.get()},e}(he),de=function(t){function e(e,r,i){var n=t.call(this)||this;if(n.pages=e,void 0===r||void 0===i){r=new Array(e.length-1),i=0;for(var o=0;o<r.length;o+=1)i+=e[o].size,r[o]=i;i+=e[r.length].size}return n.knots=r,n.size=i,n}return r(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.pages.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.size},e.prototype.get=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var r=0===e?t:t-this.knots[e-1];return this.pages[e].get(r)},e.prototype.getEntry=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var r=0===e?t:t-this.knots[e-1];return this.pages[e].getEntry(r)},e.prototype.updated=function(t,e,r){var i=this.lookup(t);i>=0?i+=1:i=-(i+1);var n=0===i?t:t-this.knots[i-1],o=this.pages[i],s=o.updated(n,e,r);return o!==s?o.size!==s.size&&r.pageShouldSplit(s)?this.updatedPageSplit(i,s,o):this.updatedPage(i,s,o):this},e.prototype.updatedPage=function(t,r,i){var n=this.pages,o=n.slice(0);o[t]=r;var s,u,p=this.knots;if(n.length-1>0){s=p.slice(0),u=t>0?p[t-1]:0;for(var a=t;a<s.length;a+=1)u+=o[a].size,s[a]=u;u+=o[s.length].size}else s=[],u=0;return new e(o,s,u)},e.prototype.updatedPageSplit=function(t,r,i){for(var n=this.pages,o=new Array(n.length+1),s=0;s<t;s+=1)o[s]=n[s];var u=r.splitLeft(r.arity>>>1),p=r.splitRight(r.arity>>>1);o[t]=u,o[t+1]=p;for(s=t+1;s<n.length;s+=1)o[s+1]=n[s];return new e(o)},e.prototype.updatedPageMerge=function(t,r,i){for(var n=this.pages,o=r.pages,s=new Array(n.length+o.length-1),u=0;u<t;u+=1)s[u]=n[u];for(u=0;u<o.length;u+=1)s[u+t]=o[u];for(u=t+1;u<n.length;u+=1)s[u+o.length-1]=n[u];return new e(s)},e.prototype.inserted=function(t,e,r,i){var n=this.lookup(t);n>=0?n+=1:n=-(n+1);var o=0===n?t:t-this.knots[n-1],s=this.pages[n],u=s.inserted(o,e,r,i);return s!==u?i.pageShouldSplit(u)?this.updatedPageSplit(n,u,s):this.updatedPage(n,u,s):this},e.prototype.removed=function(t,e){var r=this.lookup(t);r>=0?r+=1:r=-(r+1);var i=0===r?t:t-this.knots[r-1],n=this.pages[r],o=n.removed(i,e);return n!==o?this.replacedPage(r,o,n,e):this},e.prototype.replacedPage=function(t,r,i,n){return r.isEmpty()?this.pages.length>2?this.removedPage(t,r,i):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:he.empty():r instanceof e&&n.pageShouldMerge(r)?this.updatedPageMerge(t,r,i):this.updatedPage(t,r,i)},e.prototype.removedPage=function(t,r,i){for(var n=this.pages,o=new Array(n.length-1),s=0;s<t;s+=1)o[s]=n[s];for(s=t+1;s<n.length;s+=1)o[s-1]=n[s];var u,p=this.knots,a=new Array(p.length-1);if(t>0){for(s=0;s<t;s+=1)a[s]=p[s];u=p[t-1]}else u=0;for(s=t;s<a.length;s+=1)u+=o[s].size,a[s]=u;return u+=o[a.length].size,new e(o,a,u)},e.prototype.drop=function(t,r){if(t>0){if(t<this.size){var i=this.lookup(t);i>=0?i+=1:i=-(i+1),t=0===i?t:t-this.knots[i-1];var n=this.pages,o=n.length-i;if(o>1){var s=void 0;if(i>0){for(var u=new Array(o),p=0;p<o;p+=1)u[p]=n[p+i];s=new e(u)}else s=this;if(t>0){var a=n[i],h=a.drop(t,r);return s.replacedPage(0,h,a,r)}return s}return n[i].drop(t,r)}return he.empty()}return this},e.prototype.take=function(t,r){if(t<this.size){if(t>0){var i=this.lookup(t);i>=0?i+=1:i=-(i+1),t=0===i?t:t-this.knots[i-1];var n=this.pages,o=0===t?i:i+1;if(o>1){var s=void 0;if(i<n.length){for(var u=new Array(o),p=0;p<o;p+=1)u[p]=n[p];for(var a=new Array(o-1),p=0;p<a.length;p+=1)a[p]=this.knots[p];s=new e(u,a,a[o-2]+u[o-1].size)}else s=this;if(t>0){var h=n[i],f=h.take(t,r);return s.replacedPage(i,f,h,r)}return s}return t>0?n[0].take(t,r):n[0]}return he.empty()}return this},e.prototype.balanced=function(t){return this.pages.length>1&&t.pageShouldSplit(this)?this.split(this.knots.length>>>1):this},e.prototype.split=function(t){var r=new Array(2),i=this.splitLeft(t),n=this.splitRight(t);r[0]=i,r[1]=n;var o=new Array(1);return o[0]=i.size,new e(r,o,this.size)},e.prototype.splitLeft=function(t){for(var r=this.pages,i=new Array(t+1),n=0;n<t+1;n+=1)i[n]=r[n];for(var o=this.knots,s=new Array(t),n=0;n<t;n+=1)s[n]=o[n];for(var u=0,n=0;n<=t;n+=1)u+=i[n].size;return new e(i,s,u)},e.prototype.splitRight=function(t){for(var r=this.pages,i=r.length-(t+1),n=new Array(i),o=0;o<i;o+=1)n[o]=r[o+(t+1)];var s,u=new Array(i-1);if(i>0){s=n[0].size;for(o=1;o<i;o+=1)u[o-1]=s,s+=n[o].size}else s=0;return new e(n,u,s)},e.prototype.forEach=function(t,e,r,i){for(var n=0;n<this.pages.length;n+=1){var o=this.pages[n];o.forEach(t,e,r,i),r+=o.size}},e.prototype.entries=function(){return new ce(this.pages)},e.prototype.reverseEntries=function(){return new ce(this.pages,this.size,this.pages.length)},e.prototype.toValue=function(){var t=new L;t.appendField("@snode",{size:this.size});for(var e=0;e<this.pages.length;e+=1)e>0&&t.appendValue({"@knot":{index:this.knots[e-1]}}),t.appendValue(this.pages[e].toValue());return t.get()},e.prototype.lookup=function(t){for(var e=0,r=this.knots.length-1;e<=r;){var i=e+r>>>1;if(t>this.knots[i])e=i+1;else{if(!(t<this.knots[i]))return i;r=i-1}}return-(e+1)},e}(he),ce=function(t){function e(e,r,i,n){return t.call(this,e,r,i,n)||this}return r(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(te),le=new fe([]),ye={resolveUri:function(t,e){return ye.stringify(ye.resolve(t,e))},resolve:function(t,e){"string"==typeof t&&(t=ye.parse(t)),"string"==typeof e&&(e=ye.parse(e));var r={};return e.scheme?(r.scheme=e.scheme,e.authority&&(r.authority=e.authority),e.path&&(r.path=ye.removeDotSegments(e.path)),void 0!==e.query&&(r.query=e.query),void 0!==e.fragment&&(r.fragment=e.fragment)):e.authority?(t.scheme&&(r.scheme=t.scheme),r.authority=e.authority,e.path&&(r.path=ye.removeDotSegments(e.path)),void 0!==e.query&&(r.query=e.query),void 0!==e.fragment&&(r.fragment=e.fragment)):e.path&&e.path.length?"/"===e.path[0]?(t.scheme&&(r.scheme=t.scheme),t.authority&&(r.authority=t.authority),e.path&&(r.path=ye.removeDotSegments(e.path)),void 0!==e.query&&(r.query=e.query),void 0!==e.fragment&&(r.fragment=e.fragment)):(t.scheme&&(r.scheme=t.scheme),t.authority&&(r.authority=t.authority),r.path=ye.removeDotSegments(ye.mergeUriPath(t,e.path)),void 0!==e.query&&(r.query=e.query),void 0!==e.fragment&&(r.fragment=e.fragment)):(t.scheme&&(r.scheme=t.scheme),t.authority&&(r.authority=t.authority),t.path&&(r.path=t.path),void 0!==e.query?r.query=e.query:void 0!==t.query&&(r.query=t.query),void 0!==e.fragment&&(r.fragment=e.fragment)),r},mergeUriPath:function(t,e){if(!t.authority||t.path&&t.path.length)return t.path&&t.path.length?ye.mergePath(t.path.slice(),e):e;var r=e.slice();return r.unshift("/"),r},mergePath:function(t,e){for(var r=[],i=t.shift();t.length>0;)r.push(i),i=t.shift();"/"===i&&r.push(i);for(var n=0,o=e.length;n<o;n+=1)r.push(e[n]);return r},removeDotSegments:function(t){for(var e=[];t.length>0;){var r=t[0];if("."===r||".."===r)t=t.slice(t.length>1?2:1);else if("/"===r)if(t.length>1){var i=t[1];"."===i?t=t.length>2?t.slice(2):["/"]:".."===i?(t=t.length>2?t.slice(2):["/"],e.length>1&&"/"!==e[e.length-1]?e=e.slice(0,e.length-2):e.length>0&&(e=e.slice(0,e.length-1))):(e.push(r),e.push(i),t=t.slice(2))}else e.push("/"),t.shift();else e.push(r),t.shift()}return e},unresolveUri:function(t,e){return ye.stringify(ye.unresolve(t,e))},unresolve:function(t,e){if("string"==typeof t&&(t=ye.parse(t)),"string"==typeof e&&(e=ye.parse(e)),t.scheme!==e.scheme||!E(t.authority,e.authority))return e;var r={},i=t.path;i="string"==typeof i?ye.parsePath(i):i?i.slice():[];var n=e.path;"string"==typeof n?n=ye.parsePath(n):n||(n=[]);var o=ye.unmergePath(i,n.slice(),n);return o.length>0&&(r.path=o),void 0!==e.query&&(r.query=e.query),void 0!==e.fragment&&(r.fragment=e.fragment),r},unmergePath:function(t,e,r){return 0===t.length?(e.length>1&&e.shift(),e):"/"!==t[0]?e:0===e.length||"/"!==e[0]?(e.unshift("/"),e):(t.shift(),e.shift(),t.length>0&&0===e.length?["/"]:0===t.length||0===e.length||t[0]!==e[0]?e:(t.shift(),e.shift(),t.length>0&&0===e.length?r:ye.unmergePath(t,e,r)))},getHostUri:function(t){"string"==typeof t&&(t=ye.parse(t));var e={};return e.scheme=t.scheme,e.authority=t.authority,ye.stringify(e)},stringify:function(t){var e=new N,r=new Se(e);return r.writeUri(t),r.get()},parse:function(t){var e=new M(t),r=ve.parse(e);return r.isDone()&&!e.isEmpty()&&(r=X.unexpected(e)),r.bind()},parseAuthority:function(t){var e=new M(t),r=me.parse(e);return r.isDone()&&!e.isEmpty()&&(r=X.unexpected(e)),r.bind()},parsePath:function(t){var e=new M(t),r=ke.parse(e);return r.isDone()&&!e.isEmpty()&&(r=X.unexpected(e)),r.bind()}},ve=function(t){function e(e,r,i,n,o,s){var u=t.call(this)||this;return u.schemeParser=e,u.authorityParser=r,u.pathParser=i,u.queryParser=n,u.fragmentParser=o,u.step=s,u}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.schemeParser,this.authorityParser,this.pathParser,this.queryParser,this.fragmentParser,this.step)},e.parse=function(t,r,i,n,o,s,u){void 0===u&&(u=1);var p=0;if(1===u)if(t.isEmpty())t.isDone()&&(u=3);else{for(var a=t.clone();!a.isEmpty()&&(p=a.head(),S(p));)a.step();u=a.isEmpty()||58!==p?3:2}if(2===u){for(r||(r=ge.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())if(t.isEmpty()||58!==t.head()){if(!t.isEmpty())return X.expected("':'",t);if(t.isDone())return X.unexpected(t)}else t.step(),u=3;else if(r.isError())return r.asError()}if(3===u)if(t.isEmpty()){if(t.isDone()){h={};return r&&(h.scheme=r.bind()),X.done(h)}}else 47===(p=t.head())?(t.step(),u=4):63===p?(t.step(),u=7):35===p?(t.step(),u=8):u=6;if(4===u)if(t.isEmpty()||47!==t.head())if(t.isEmpty()){if(t.isDone()){h={};return r&&(h.scheme=r.bind()),h.path=["/"],X.done(h)}}else n=ke.parse(t,["/"]),u=6;else t.step(),u=5;if(5===u){for(i||(i=me.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone())if(t.isEmpty()){if(t.isDone()){h={};return r&&(h.scheme=r.bind()),i&&(h.authority=i.bind()),X.done(h)}}else 63===(p=t.head())?(t.step(),u=7):35===p?(t.step(),u=8):u=6;else if(i.isError())return i.asError()}if(6===u){for(n||(n=ke.parse(t));(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(n.isDone())if(t.isEmpty()||63!==t.head())if(t.isEmpty()||35!==t.head()){if(!t.isEmpty()||t.isDone()){h={};return r&&(h.scheme=r.bind()),i&&(h.authority=i.bind()),h.path=n.bind(),X.done(h)}}else t.step(),u=8;else t.step(),u=7;else if(n.isError())return n.asError()}if(7===u){for(o||(o=Pe.parse(t));(!t.isEmpty()||t.isDone())&&o.isCont();)o=o.feed(t);if(o.isDone())if(t.isEmpty()||35!==t.head()){if(!t.isEmpty()||t.isDone()){h={};return r&&(h.scheme=r.bind()),i&&(h.authority=i.bind()),n&&(h.path=n.bind()),h.query=o.bind(),X.done(h)}}else t.step(),u=8;else if(o.isError())return o.asError()}if(8===u){for(s||(s=Ce.parse(t));(!t.isEmpty()||t.isDone())&&s.isCont();)s=s.feed(t);if(s.isDone()){var h={};return r&&(h.scheme=r.bind()),i&&(h.authority=i.bind()),n&&(h.path=n.bind()),o&&(h.query=o.bind()),h.fragment=s.bind(),X.done(h)}if(s.isError())return s.asError()}return new e(r,i,n,o,s,u)},e}(X),ge=function(t){function e(e,r){var i=t.call(this)||this;return i.output=e,i.step=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.step)},e.parse=function(t,r,i){void 0===i&&(i=1);var n=0;if(1===i)if(!t.isEmpty()&&(n=t.head(),X.isAlpha(n)))t.step(),(r=r||new N).write(O(n)),i=2;else if(!t.isEmpty()||t.isDone())return X.expected("scheme",t);if(2===i){for(;!t.isEmpty()&&(n=t.head(),S(n));)t.step(),r.write(O(n));if(!t.isEmpty()||t.isDone())return X.done(r.get())}return new e(r,i)},e}(X),me=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.userParser=e,o.hostParser=r,o.portParser=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.userParser,this.hostParser,this.portParser,this.step)},e.parse=function(t,r,i,n,o){void 0===o&&(o=1);var s=0;if(1===o)if(t.isEmpty())t.isDone()&&(o=3);else{for(var u=t.clone();!u.isEmpty()&&64!==(s=u.head())&&47!==s;)u.step();o=u.isEmpty()||64!==s?3:2}if(2===o){for(r||(r=we.parse(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())if(t.isEmpty()||64!==t.head()){if(!t.isEmpty())return X.expected(64,t);if(t.isDone())return X.unexpected(t)}else t.step(),o=3;else if(r.isError())return r.asError()}if(3===o){for(i||(i=Ee.parse(t));(!t.isEmpty()||t.isDone())&&i.isCont();)i=i.feed(t);if(i.isDone())if(t.isEmpty()||58!==t.head()){if(!t.isEmpty()||t.isDone()){p={};if(r){"string"==typeof(a=r.bind())?p.username=a:a&&(p.username=a.username,p.password=a.password)}return void 0!==(h=i.bind()).name&&(p.host=h.name),void 0!==h.ipv4&&(p.ipv4=h.ipv4),void 0!==h.ipv6&&(p.ipv6=h.ipv6),X.done(p)}}else t.step(),o=4;else if(i.isError())return i.asError()}if(4===o){for(n||(n=De.parse(t));(!t.isEmpty()||t.isDone())&&n.isCont();)n=n.feed(t);if(n.isError())return n.asError();if(!t.isEmpty()||t.isDone()){var p={};if(r){var a=r.bind();"string"==typeof a?p.username=a:a&&(p.username=a.username,p.password=a.password)}var h=i.bind();return void 0!==h.name&&(p.host=h.name),void 0!==h.ipv4&&(p.ipv4=h.ipv4),void 0!==h.ipv6&&(p.ipv6=h.ipv6),p.port=n.bind(),X.done(p)}}return new e(r,i,n,o)},e}(X),we=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.usernameOutput=e,o.passwordOutput=r,o.c1=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.usernameOutput,this.passwordOutput,this.c1,this.step)},e.parse=function(t,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===o){for(r||t.isEmpty()||(r=new N);!t.isEmpty()&&(s=t.head(),A(s));)t.step(),r.write(s);if(t.isEmpty()||58!==s)if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return X.done(r.get())}else t.step(),o=2;else t.step(),o=4}if(2===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),n=s,o=3;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(3===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),r.write((X.decodeHexChar(n)<<4)+X.decodeHexChar(s)),n=0,o=1;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(4===o){for(i=i||new N;!t.isEmpty()&&(s=t.head(),V(s));)t.step(),i.write(s);if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return X.done({username:r.get(),password:i.get()})}else t.step(),o=5}if(5===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),n=s,o=6;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(6===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),i.write((X.decodeHexChar(n)<<4)+X.decodeHexChar(s)),n=0,o=4;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}}return new e(r,i,n,o)},e}(X),Ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.feed=function(t){return e.parse(t)},e.parse=function(t){if(!t.isEmpty()){return 91===t.head()?be.parse(t):xe.parse(t)}return t.isDone()?X.done({}):new e},e}(X),xe=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.output=e,o.c1=r,o.x=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.c1,this.x,this.step)},e.parse=function(t,r,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=1);for(var s=0;o<=4&&(!t.isEmpty()||t.isDone());){for(r=r||new N;!t.isEmpty()&&(s=t.head(),X.isDigit(s));)t.step(),r.write(s),n=10*n+B(s);if(t.isEmpty()){if(t.isDone())return 4===o&&n<=255?X.done({ipv4:r.get()}):X.done({name:r.get()})}else if(46===s&&o<4&&n<=255)t.step(),r.write(s),n=0,o+=1;else{if(!F(s)&&37!==s&&4===o&&n<=255)return X.done({ipv4:r.get()});n=0,o=5}}for(;!t.isEmpty()||t.isDone();){if(r=r,5===o){for(;!t.isEmpty()&&(s=t.head(),F(s));)t.step(),r.write(O(s));if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return X.done({name:r.get()})}else t.step(),o=6}if(6===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),i=s,o=7;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(7===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),r.write((X.decodeHexChar(i)<<4)+X.decodeHexChar(s)),i=0,o=5;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}}return new e(r,i,n,o)},e}(X),be=function(t){function e(e,r){var i=t.call(this)||this;return i.output=e,i.step=r,i}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.step)},e.parse=function(t,r,i){void 0===i&&(i=1);var n=0;if(1===i)if(t.isEmpty()||91!==(n=t.head())){if(!t.isEmpty())return X.expected("'['",t);if(t.isDone())return X.unexpected(t)}else t.step(),i=2;if(2===i){for(r=r||new N;!t.isEmpty()&&(n=t.head(),F(n)||58===n);)t.step(),r.write(O(n));if(!t.isEmpty()&&93===n)return t.step(),X.done({ipv6:r.get()});if(!t.isEmpty()||t.isDone())return X.unexpected(t)}return new e(r,i)},e}(X),De=function(t){function e(e){var r=t.call(this)||this;return r.port=e,r}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.port)},e.parse=function(t,r){void 0===r&&(r=0);for(var i=0;!t.isEmpty()&&(i=t.head(),X.isDigit(i));)t.step(),r=10*r+B(i);return!t.isEmpty()||t.isDone()?X.done(r):new e(r)},e}(X),ke=function(t){function e(e,r,i,n){var o=t.call(this)||this;return o.path=e,o.output=r,o.c1=i,o.step=n,o}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.path,this.output,this.c1,this.step)},e.parse=function(t,r,i,n,o){void 0===n&&(n=0),void 0===o&&(o=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===o){for(;!t.isEmpty()&&(s=t.head(),z(s));)i=i||new N,t.step(),i.write(s);if(t.isEmpty()||47!==s)if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return r=r||[],i&&r.push(i.get()),X.done(r)}else t.step(),o=2;else t.step(),r=r||[],i&&(r.push(i.get()),i=void 0),r.push("/")}if(2===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))t.step(),n=s,o=3;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(3===o)if(!t.isEmpty()&&(s=t.head(),X.isHexChar(s)))i=i||new N,t.step(),i.write((X.decodeHexChar(n)<<4)+X.decodeHexChar(s)),n=0,o=1;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}}return new e(r,i,n,o)},e}(X),Pe=function(t){function e(e,r,i,n,o){var s=t.call(this)||this;return s.keyOutput=e,s.valueOutput=r,s.builder=i,s.c1=n,s.step=o,s}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.keyOutput,this.valueOutput,this.builder,this.c1,this.step)},e.parse=function(t,r,i,n,o,s){void 0===o&&(o=0),void 0===s&&(s=1);for(var u=0;!t.isEmpty()||t.isDone();){if(1===s){for(r=r||new N;!t.isEmpty()&&(u=t.head(),I(u));)t.step(),r.write(u);if(t.isEmpty()||61!==u)if(t.isEmpty()||38!==u)if(t.isEmpty()||37!==u){if(!t.isEmpty()||t.isDone())return n?(n.appendValue(r.get()),X.done(n.get())):X.done(r.get())}else t.step(),s=2;else t.step(),(n=n||new Q).appendValue(r.get()),r=void 0,s=1;else t.step(),s=4}if(2===s)if(!t.isEmpty()&&(u=t.head(),X.isHexChar(u)))t.step(),o=u,s=3;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(3===s)if(!t.isEmpty()&&(u=t.head(),X.isHexChar(u)))t.step(),r.write((X.decodeHexChar(o)<<4)+X.decodeHexChar(u)),o=0,s=1;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(4===s){for(i=i||new N;!t.isEmpty()&&(u=t.head(),I(u)||61===u);)t.step(),i.write(u);if(t.isEmpty()||38!==u)if(t.isEmpty()||38!==u){if(!t.isEmpty()||t.isDone())return(n=n||new Q).appendField(r.get(),i.get()),X.done(n.get())}else t.step(),s=5;else t.step(),(n=n||new Q).appendField(r.get(),i.get()),r=void 0,i=void 0,s=1}if(5===s)if(!t.isEmpty()&&(u=t.head(),X.isHexChar(u)))t.step(),o=u,s=6;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(6===s)if(!t.isEmpty()&&(u=t.head(),X.isHexChar(u)))t.step(),i.write((X.decodeHexChar(o)<<4)+X.decodeHexChar(u)),o=0,s=4;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}}return new e(r,i,n,o,s)},e}(X),Ce=function(t){function e(e,r,i){var n=t.call(this)||this;return n.output=e,n.c1=r,n.step=i,n}return r(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.c1,this.step)},e.parse=function(t,r,i,n){void 0===r&&(r=new N),void 0===i&&(i=0),void 0===n&&(n=1);for(var o=0;!t.isEmpty()||t.isDone();){if(1===n){for(;!t.isEmpty()&&(o=t.head(),$(o));)t.step(),r.write(o);if(t.isEmpty()||37!==o){if(!t.isEmpty()||t.isDone())return X.done(r.get())}else t.step(),n=2}if(2===n)if(!t.isEmpty()&&(o=t.head(),X.isHexChar(o)))t.step(),i=o,n=3;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}if(3===n)if(!t.isEmpty()&&(o=t.head(),X.isHexChar(o)))t.step(),r.write((X.decodeHexChar(i)<<4)+X.decodeHexChar(o)),i=0,n=1;else{if(!t.isEmpty())return X.expected("hex digit",t);if(t.isDone())return X.unexpected(t)}}return new e(r,i,n)},e}(X),Se=function(){function t(t){this.output=t}return t.prototype.writeUri=function(t){void 0!==t.scheme&&(this.writeScheme(t.scheme),this.output.write(58)),t.authority&&(this.output.write(47),this.output.write(47),this.writeAuthority(t.authority)),t.path&&this.writePath(t.path),void 0!==t.query&&(this.output.write(63),this.writeQuery(t.query)),void 0!==t.fragment&&(this.output.write(35),this.writeFragment(t.fragment))},t.prototype.writeScheme=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();if(!S(r))throw"nvalid URI scheme: "+t;this.output.write(r),e.step()}},t.prototype.writeAuthority=function(t){"string"==typeof t&&(t=ye.parseAuthority(t)),void 0!==t.username&&void 0!==t.password?(this.writeUsername(t.username),this.output.write(58),this.writeUserinfo(t.password),this.output.write(64)):void 0!==t.username&&(this.writeUserinfo(t.username),this.output.write(64)),void 0!==t.host?this.writeHostAddress(t.host):void 0!==t.ipv4?this.writeHostAddress(t.ipv4):void 0!==t.ipv6&&(this.output.write(91),this.writeHostLiteral(t.ipv6),this.output.write(93)),t.port&&(this.output.write(58),this.writePort(t.port))},t.prototype.writeUsername=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();A(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeUserinfo=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();V(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeHostAddress=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();F(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeHostLiteral=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();F(r)||58===r?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writePort=function(t){for(var e=9,r=new Array(10);t>0;)r[e]=t%10,t=Math.floor(t/10),e-=1;for(e+=1;e<10;)this.output.write(48+r[e]),e+=1},t.prototype.writePath=function(t){"string"==typeof t&&(t=ye.parsePath(t));for(var e=0;e<t.length;e+=1){var r=t[e];"/"===r?this.output.write(47):this.writePathSegment(r)}},t.prototype.writePathSegment=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();z(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeQuery=function(t){"string"==typeof t?this.writeQueryPart(t):this.writeQueryParams(i(t))},t.prototype.writeQueryPart=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();q(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeQueryParams=function(t,e){for(void 0===e&&(e=0);!t.isEmpty();){var r=t.headKey(),i=t.headValue();e>0&&this.output.write(38),void 0!==r&&(this.writeQueryParam(r),this.output.write(61)),this.writeQueryParam(i),t.step(),e+=1}},t.prototype.writeQueryParam=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();I(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeFragment=function(t){for(var e=new M(t);!e.isEmpty();){var r=e.head();$(r)?this.output.write(r):this.writeEncoded(r),e.step()}},t.prototype.writeEncoded=function(t){0===t?(this.writePctEncoded(192),this.writePctEncoded(128)):t>=0&&t<=127?this.writePctEncoded(t):t>=128&&t<=2047?(this.writePctEncoded(192|t>>>6),this.writePctEncoded(128|63&t)):t>=2048&&t<=65535||t>=57344&&t<=65535?(this.writePctEncoded(224|t>>>12),this.writePctEncoded(128|t>>>6&63),this.writePctEncoded(128|63&t)):t>=65536&&t<=1114111?(this.writePctEncoded(240|t>>>18),this.writePctEncoded(128|t>>>12&63),this.writePctEncoded(128|t>>>6&63),this.writePctEncoded(128|63&t)):(this.writePctEncoded(239),this.writePctEncoded(191),this.writePctEncoded(189))},t.prototype.writePctEncoded=function(t){this.output.write(37),this.output.write(T(t>>>4&15)),this.output.write(T(15&t))},t.prototype.get=function(){return this.output.get()},t}(),Ve=function(){function t(t,e){void 0===e&&(e=32),this.baseUri=t,this.base=ye.parse(t),this.size=e,this.resolveCache=new Array(e),this.unresolveCache=new Array(e)}return t.prototype.resolveUri=function(t){var e=Math.abs(U.hash(t)%this.size),r=this.resolveCache[e];if(r&&r.unresolved===t)return r.resolved;var i=ye.resolveUri(this.base,t);return this.resolveCache[e]={unresolved:t,resolved:i},i},t.prototype.unresolveUri=function(t){var e=Math.abs(U.hash(t)%this.size),r=this.unresolveCache[e];if(r&&r.resolved===t)return r.unresolved;var i=ye.unresolveUri(this.base,t);return this.unresolveCache[e]={unresolved:i,resolved:t},i},t}();t.Murmur3=U,t.getRandomValues=yt,t.generateId=function(t){void 0===t&&(t=12);var e=new Uint8Array(t);yt(e);var r=new N;return new ct(r).writeBase64(e),r.get()},t.Input=j,t.StringInput=M,t.Iteratee=X,t.Output=R,t.StringOutput=N,t.Extant=null,t.Absent=K,t.RecordBuilder=L,t.ValueBuilder=Q,t.ReconIterator=W,t.iterator=i,t.isRecord=o,t.length=function(t){if(o(t)){var e=t,r=e.length;return"number"==typeof r?r:Object.keys(e).length}return 0},t.tag=function(t){if(o(t)){"number"==typeof t.length&&(t=t[0]);for(var e in t){if(e.length>0&&64===e.charCodeAt(0))return e;break}}return null},t.target=function(t){if(o(t))for(var e=i(t);!e.isEmpty();){if(e.atValue())return e.head();e.step()}return t},t.flattened=function(t){if(o(t)){var e=i(t);if(!e.isEmpty()){var r=e.head();if(e.step(),e.isEmpty())return r}}return t},t.header=a,t.headers=function(t,e){var r=a(t,e);return void 0===r||o(r)||(r=[r]),r},t.head=function(t){if(o(t)){var e=t;if("number"==typeof e.length)return e[0];var r=i(e);if(!r.isEmpty())return r.head()}return K},t.headKey=function(t){var e=i(t);if(!e.isEmpty()&&e.atField()){var r=e.head(),n=r.$key;if(void 0!==n)return n;for(n in r)return n}return K},t.tail=h,t.body=function(t){return h(t,new Q)},t.has=function(t,e){return f(t,e)!==K},t.get=f,t.getIndex=d,t.set=c,t.setIndex=l,t.remove=y,t.removeIndex=v,t.getKey=g,t.getValue=m,t.field=w,t.keys=function(t){if(s(t)){for(var e=[],r=i(t);!r.isEmpty();){if(r.atField()){var n=r.head(),o=n.$key;void 0!==o?e.push(o):Array.prototype.push.apply(e,Object.keys(n))}r.step()}return e}return[]},t.values=function(t){if(o(t)){if(Array.isArray(t))return t;for(var e=[],r=i(t);!r.isEmpty();){var n=r.head();if(r.atField()){var s=n,u=s.$key;if(void 0!==u)e.push(s.$value);else for(u in s)e.push(s[u])}else e.push(n);r.step()}return e}return[]},t.forEach=function(t,e,r){if(o(t))for(var n=i(t),s=0;!n.isEmpty();){var u=n.head();if(n.atField()){var p=u,a=p.$key;if(void 0!==a)e.call(r,p.$value,a,s,t);else for(a in p)e.call(r,p[a],a,s,t)}else e.call(r,u,K,s,t);n.step(),s+=1}else e.call(r,t,K,0,t)},t.filter=function(t,e,r){var n=new L;if(o(t))for(var s=i(t),u=0;!s.isEmpty();){var p=s.head();if(s.atField()){var a=p,h=a.$key;if(void 0!==h)f=a.$value,e.call(r,f,h,u,t)&&n.appendField(h,f);else for(h in a){var f=a[h];e.call(r,f,h,u,t)&&n.appendField(h,f)}}else e.call(r,p,void 0,u,t)&&n.appendValue(p);s.step(),u+=1}return n.get()},t.collect=function(t,e,r){var n=new L;if(o(t))for(var s=i(t),u=0;!s.isEmpty();){var p=s.head();if(s.atField()){var a=p,h=a.$key;if(void 0!==h)f=a.$value,void 0!==(f=e.call(r,f,h,u,t))&&n.appendField(h,f);else for(h in a)f=a[h],void 0!==(f=e.call(r,f,h,u,t))&&n.appendField(h,f)}else{var f;void 0!==(f=e.call(r,p,void 0,u,t))&&n.appendValue(f)}s.step(),u+=1}return n.get()},t.concat=function(t,e){var r=new L;return o(t)?r.appendRecord(t):void 0!==t&&r.appendItem(t),o(e)?r.appendRecord(e):void 0!==e&&r.appendItem(e),r.get()},t.equal=E,t.compare=x,t.DataBuilder=tt,t.base64=function(t){if(void 0===t)return new Uint8Array(0);for(var e=new tt,r=new M(t);!r.isEmpty();)e.appendBase64Char(r.head()),r.step();return e.get()},t.BlockParser=et,t.AttrParser=rt,t.BlockValueParser=it,t.InlineValueParser=nt,t.RecordParser=ot,t.MarkupParser=st,t.DataParser=ut,t.IdentParser=pt,t.StringParser=at,t.NumberParser=ht,t.parse=function(t){for(var e=new M(t);!e.isEmpty()&&X.isWhitespace(e.head());)e.step();var r=et.parse(e);if(r.isDone()){for(;!e.isEmpty()&&X.isWhitespace(e.head());)e.step();e.isEmpty()||(r=X.unexpected(e))}return r.bind()},t.ReconWriter=ct,t.stringify=k,t.Selector=vt,t.Filter=Dt,t.SelectorParser=Ht,t.Splicer=Qt,t.SplicerParser=Xt,t.Cursor=Yt,t.BTree=ie,t.BTreePage=ne,t.STree=ae,t.STreePage=he,t.Uri=ye,t.UriParser=ve,t.UriSchemeParser=ge,t.UriAuthorityParser=me,t.UriPathParser=ke,t.UriQueryParser=Pe,t.UriFragmentParser=Ce,t.UriWriter=Se,t.UriCache=Ve,Object.defineProperty(t,"__esModule",{value:!0})});