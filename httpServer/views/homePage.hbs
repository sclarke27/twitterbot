<script src="/assets/swim-app.js" swim-app></script>

<script type="text/recon">
@quilt {
	blockAspectRatio: 1.42
	minBlockWidth: 10
    host: 'ws://raspi5:5620'
    temperature: @link(node: '/sensor/temperature', lane: 'latest', type: value)
    pressure: @link(node: '/sensor/pressure', lane: 'latest', type: value)
    humidity: @link(node: '/sensor/humidity', lane: 'latest', type: value)
    accelerationX: @link(node: '/sensor/accelerationX', lane: 'latest', type: value)
    accelerationY: @link(node: '/sensor/accelerationY', lane: 'latest', type: value)
    accelerationZ: @link(node: '/sensor/accelerationZ', lane: 'latest', type: value)
    compassX: @link(node: '/sensor/compassX', lane: 'latest', type: value)
    compassY: @link(node: '/sensor/compassY', lane: 'latest', type: value)
    compassZ: @link(node: '/sensor/compassZ', lane: 'latest', type: value)
    gyroX: @link(node: '/sensor/gyroX', lane: 'latest', type: value)
    gyroY: @link(node: '/sensor/gyroY', lane: 'latest', type: value)
    gyroZ: @link(node: '/sensor/gyroZ', lane: 'latest', type: value)
    joystickState: @link(node: '/sensor/joystickState', lane: 'latest', type: value)
    transition: @transition(150, linear)

    @block {
        @card {
            title: @text([Temperature: { $round($eager($temperature#0)) || 0}Â°C])
            body: @chart {

                # data link information
                node: '/sensor/temperature'
                lane: 'history'
                linkData: @link(host: $host, node: $node, lane: $lane, type: value)

                # chart plot 1
                @plot(type: line) {
                    history0: @link(node: $node, lane: $lane, type: map)
                    lineColor: '#ff0000'
                    @each(t: $history0.*:) {
                        key: $t
                        @plotPoint {
                        v: @let($history0.($t))
                        x: $t
                        y: $v
                        }
                    }
                }

                # style information
                id: tempChart
                
                top: {
                    gutter: '0px'
                }
                right: {
                    gutter: '40px'
                }
                bottom: @axis(type: time) {
                    gutter: '30px'
                }
                left: @axis(type: linear) {
                    gutter: '40px'
                    domain: {0, 100}
                }

                domainBoundLeft: true
                domainBoundBottom: false

            }
        }
        @card {
            title: @text([Pressure: { $round($eager($pressure#0)) || 0}mb])
            body: @chart {

                # data link information
                node: '/sensor/pressure'
                lane: 'history'
                linkData: @link(host: $host, node: $node, lane: $lane, type: value)

                # chart plot 1
                @plot(type: line) {
                    history0: @link(node: $node, lane: $lane, type: map)
                    lineColor: '#ff0000'
                    @each(t: $history0.*:) {
                        key: $t
                        @plotPoint {
                        v: @let($history0.($t))
                        x: $t
                        y: $v
                        }
                    }
                }

                # style information
                id: tempChart
                
                top: {
                    gutter: '0px'
                }
                right: {
                    gutter: '40px'
                }
                bottom: @axis(type: time) {
                    gutter: '30px'
                }
                left: @axis(type: linear) {
                    gutter: '40px'
                    domain: {0, 100}
                }

                domainBoundLeft: true
                domainBoundBottom: false

            }
        }    
        @card {
            title: @text([Humidity: { $round($eager($humidity#0)) || 0}%])
            body: @chart {

                # data link information
                node: '/sensor/humidity'
                lane: 'history'
                linkData: @link(host: $host, node: $node, lane: $lane, type: value)

                # chart plot 1
                @plot(type: line) {
                    history0: @link(node: $node, lane: $lane, type: map)
                    lineColor: '#ff0000'
                    @each(t: $history0.*:) {
                        key: $t
                        @plotPoint {
                        v: @let($history0.($t))
                        x: $t
                        y: $v
                        }
                    }
                }

                # style information
                id: tempChart
                
                top: {
                    gutter: '0px'
                }
                right: {
                    gutter: '40px'
                }
                bottom: @axis(type: time) {
                    gutter: '30px'
                }
                left: @axis(type: linear) {
                    gutter: '40px'
                    domain: {0, 100}
                }

                domainBoundLeft: true
                domainBoundBottom: false

            }
        }             

    }
    @block {
        @card {
            title: 'Compass'
            body: @pie {
                

                @wedge {
                    arcColor: '#ff0000'
                    value: $compassX#0
                }
                @wedge {
                    arcColor: '#00ff00'
                    value: $compassY#0
                }
                @wedge {
                    arcColor: '#0000ff'
                    value: $compassZ#0
                }
            }
        }
        @card {
            title: @text([Gyro X: {$round($eager($gyroX#0)) || 0} Y: {$round($eager($gyroY#0)) || 0} Z: {$round($eager($gyroZ#0)) || 0}])
            body: @div {
                style: {
                    display: flex
                    flex-direction: row
                    flex-grow: 1
                }
                @div {
                    @gauge {
                        width: 100
                        mainValue: $gyroX#0
                        # Gauge Values
                        meter: $mainValue/300
                        value: @text([{ $round($eager($mainValue/300 * 100)) || 0}%])

                        # Gauge Style
                        id: gauge
                        transition: @transition(400, linear)
                        innerRadius: 70 @pct
                        dialCornerRadius: 50 @pct
                        dialColor: '#56d7ba'
                        faceColor: '#eaecf4'
                        valueColor: '#56d7ba'
                        valueWeight: 400
                        valueSize: 40 @pct
                    }
                }
                @div {
                    @gauge {
                        width: 100
                        mainValue: $gyroY#0
                        # Gauge Values
                        meter: $mainValue/300
                        value: @text([{ $round($eager($mainValue/300 * 100)) || 0}%])

                        # Gauge Style
                        id: gauge
                        transition: @transition(400, linear)
                        innerRadius: 70 @pct
                        dialCornerRadius: 50 @pct
                        dialColor: '#56d7ba'
                        faceColor: '#eaecf4'
                        valueColor: '#56d7ba'
                        valueWeight: 400
                        valueSize: 40 @pct
                    }
                }      
                @div {
                    @gauge {
                        width: 100
                        mainValue: $gyroZ#0
                        # Gauge Values
                        meter: $mainValue/300
                        value: @text([{ $round($eager($mainValue/300 * 100)) || 0}%])

                        # Gauge Style
                        id: gauge
                        transition: @transition(400, linear)
                        innerRadius: 70 @pct
                        dialCornerRadius: 50 @pct
                        dialColor: '#56d7ba'
                        faceColor: '#eaecf4'
                        valueColor: '#56d7ba'
                        valueWeight: 400
                        valueSize: 40 @pct
                    }
                }                          
            }

        }   
        
    }
    @block {
        @card {
            title: @text([Acceleration X: { $round($eager($accelerationX#0)) || 0}])
            body: @chart {

                # data link information
                node: '/sensor/accelerationX'
                lane: 'history'
                linkData: @link(host: $host, node: $node, lane: $lane, type: value)

                # chart plot 1
                @plot(type: line) {
                    history0: @link(node: $node, lane: $lane, type: map)
                    lineColor: '#0000ff'
                    @each(t: $history0.*:) {
                        key: $t
                        @plotPoint {
                        v: @let($history0.($t))
                        x: $t
                        y: $v
                        }
                    }
                }

                # style information
                id: tempChart
                
                top: {
                    gutter: '0px'
                }
                right: {
                    gutter: '40px'
                }
                bottom: @axis(type: time) {
                    gutter: '30px'
                }
                left: @axis(type: linear) {
                    gutter: '40px'
                }

                domainBoundLeft: true
                domainBoundRight: true

                domainPaddingTop: 1
                domainPaddingBottom: 1
            }
        }
        @card {
            title: @text([Acceleration Y: { $round($eager($accelerationY#0)) || 0}])
            body: @chart {

                # data link information
                node: '/sensor/accelerationY'
                lane: 'history'
                linkData: @link(host: $host, node: $node, lane: $lane, type: value)

                # chart plot 1
                @plot(type: line) {
                    history0: @link(node: $node, lane: $lane, type: map)
                    lineColor: '#0000ff'
                    @each(t: $history0.*:) {
                        key: $t
                        @plotPoint {
                        v: @let($history0.($t))
                        x: $t
                        y: $v
                        }
                    }
                }

                # style information
                id: tempChart
                
                top: {
                    gutter: '0px'
                }
                right: {
                    gutter: '40px'
                }
                bottom: @axis(type: time) {
                    gutter: '30px'
                }
                left: @axis(type: linear) {
                    gutter: '40px'
                }

                domainBoundLeft: true
                domainBoundRight: true

                domainPaddingTop: 1
                domainPaddingBottom: 1
            }
        }
        @card {
            title: @text([Acceleration Z: { $round($eager($accelerationZ#0)) || 0}])
            body: @chart {

                # data link information
                node: '/sensor/accelerationZ'
                lane: 'history'
                linkData: @link(host: $host, node: $node, lane: $lane, type: value)

                # chart plot 1
                @plot(type: line) {
                    history0: @link(node: $node, lane: $lane, type: map)
                    lineColor: '#0000ff'
                    @each(t: $history0.*:) {
                        key: $t
                        @plotPoint {
                        v: @let($history0.($t))
                        x: $t
                        y: $v
                        }
                    }
                }

                # style information
                id: tempChart
                
                top: {
                    gutter: '0px'
                }
                right: {
                    gutter: '40px'
                }
                bottom: @axis(type: time) {
                    gutter: '30px'
                }
                left: @axis(type: linear) {
                    gutter: '40px'
                    domain: {0,120}
                }

                domainBoundLeft: true
                domainBoundRight: true

                domainPaddingTop: 1
                domainPaddingBottom: 1
            }
        }             
    }    
    
}


</script>

<script type="text/recon">

</script>
